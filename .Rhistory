kidnapping1df$muni_code_hecho <- substr(kidnapping1df$muni_code_hecho, nchar(kidnapping1df$muni_code_hecho) - 2, nchar(kidnapping1df$muni_code_hecho))
#recruitment
recruitment1df <- recruitment1df %>% mutate(
dept_code_hecho = ifelse(dept_code_hecho < 10 , sprintf("%02d", dept_code_hecho) %>% as.character(), as.character(dept_code_hecho)),
muni_code_hecho = ifelse(muni_code_hecho < 10 , sprintf("%02d", muni_code_hecho) %>% as.character(), as.character(muni_code_hecho))
)
recruitment1df <-recruitment1df[,-c(3:36,1,51)]
recruitment1df$muni_code_hecho <- substr(recruitment1df$muni_code_hecho, nchar(recruitment1df$muni_code_hecho) - 2, nchar(recruitment1df$muni_code_hecho))
#aplicando las funciones de dplyr para un data frame
#datos por municipio
homicides_group_year_mun <- homicide1df %>%
group_by(yy_hecho,muni_code_hecho, dept_code_hecho) %>%
summarise(n=n())
# datos por año
disappearance_per_year <- disappearance1df%>%
group_by(yy_hecho) %>%
summarise(n=n())
homicides_per_year <- homicide1df%>%
group_by(yy_hecho) %>%
summarise(n=n())
kidnapping_per_year <- kidnapping1df%>%
group_by(yy_hecho) %>%
summarise(n=n())
recruitment_per_year <- recruitment1df%>%
group_by(yy_hecho) %>%
summarise(n=n())
#datos por grupo
homicides_per_group <- homicide1df %>%
mutate(Grupo = case_when(
grepl("GUE",p_str) ~ "GUERRILLA",
grepl("PARA",p_str) ~ "PARAMILITARES",
grepl("EST",p_str) ~ "ESTADO",
grepl("multiple",p_str) ~ "MULTIPLE",
TRUE ~ "OTRO"
)) %>%
group_by(yy_hecho,Grupo) %>%
summarise(n=n())
kidnapping_per_group <- kidnapping1df %>%
mutate(Grupo = case_when(
grepl("GUE",p_str) ~ "GUERRILLA",
grepl("PARA",p_str) ~ "PARAMILITARES",
grepl("EST",p_str) ~ "ESTADO",
grepl("multiple",p_str) ~ "MULTIPLE",
TRUE ~ "OTRO"
)) %>%
group_by(yy_hecho,Grupo) %>%
summarise(n=n())
View(disappearance1df)
View(homicide1df)
View(kidnapping1df)
kidnapp_homicidie <-merge(homicide1df, kidnapping1df, by = "match_group_id", all = TRUE)
View(kidnapp_homicidie)
idnapp_homicidie <-inner_join(homicide1df, kidnapping1df, by = "match_group_id")
kidnapp_homicidie <-inner_join(homicide1df, kidnapping1df, by = "match_group_id")
rm(idnapp_homicidie)
View(kidnapp_homicidie)
valores_comunes2 <- intersect(homicide1df$match_group_id, kidnapping1df$match_group_id)
View(kidnapping_per_group)
kidnapping_homicide_per_group <- kidnapp_homicidie %>%
mutate(Grupo = case_when(
grepl("GUE",p_str) ~ "GUERRILLA",
grepl("PARA",p_str) ~ "PARAMILITARES",
grepl("EST",p_str) ~ "ESTADO",
grepl("multiple",p_str) ~ "MULTIPLE",
TRUE ~ "OTRO"
)) %>%
group_by(yy_hecho,Grupo) %>%
summarise(n=n())
kidnapping_homicide_per_group <- kidnapp_homicidie %>%
mutate(Grupo = case_when(
grepl("GUE",p_str) ~ "GUERRILLA",
grepl("PARA",p_str) ~ "PARAMILITARES",
grepl("EST",p_str) ~ "ESTADO",
grepl("multiple",p_str) ~ "MULTIPLE",
TRUE ~ "OTRO"
)) %>%
group_by(yy_hecho,Grupo) %>%
summarise(n=n())
View(kidnapp_homicidie)
kidnapping_homicide_per_group <- kidnapp_homicidie %>%
mutate(Grupo = case_when(
grepl("GUE",p_str.x) ~ "GUERRILLA",
grepl("PARA",p_str.x) ~ "PARAMILITARES",
grepl("EST",p_str.x) ~ "ESTADO",
grepl("multiple",p_str.x) ~ "MULTIPLE",
TRUE ~ "OTRO"
)) %>%
group_by(yy_hecho.x,Grupo) %>%
summarise(n=n())
View(kidnapping_homicide_per_group)
library(sf)
library(tmap)
library(readr)
library(ggplot2)
library(disk.frame)
library(dplyr)
library(purrr)
homicide_route <- "../Homicidio.csv/verdata-homicidio-R99.csv"
kidnapping_route <- "../Secuestro.csv/verdata-secuestro-R99.csv"
disappearances_route <- "../Desaparicion.csv/verdata-desaparicion-R99.csv"
recruitment_route <-"../Reclutamiento.csv/verdata-reclutamiento-R99.csv"
library(readr)
library(ggplot2)
library(disk.frame)
library(dplyr)
library(purrr)
homicide1df <-read.csv(homicide_route)
#homicide
homicide1df <- homicide1df %>% mutate(
dept_code_hecho = ifelse(dept_code_hecho < 10 , sprintf("%02d", dept_code_hecho) %>% as.character(), as.character(dept_code_hecho)),
muni_code_hecho = ifelse(muni_code_hecho < 10 , sprintf("%02d", muni_code_hecho) %>% as.character(), as.character(muni_code_hecho))
)
homicide1df <-homicide1df[,-c(3:36,1,51)]
#homicide1df$muni_code_hecho <- substr(homicide1df$muni_code_hecho, nchar(homicide1df$muni_code_hecho) - 2, nchar(homicide1df$muni_code_hecho))
homicides_group_mun <- homicide1df %>%
group_by(muni_code_hecho) %>%
summarise(n=n())
map <- st_read("Mapas_mun/MunicipiosVeredas.shp")
homicides_group_mun$DPTOMPIO<-factor(homicides_group_mun$muni_code_hecho)
homicides_group_mun$muni_code_hecho<-NULL
homicides_group_mun$homicidios<-homicides_group_mun$n
homicides_group_mun$n<-NULL
map <- map[,c(1,2,3)]
map <- left_join(map, homicides_group_mun)
qtm(map,"homicidios", fill.breaks = c(0,1000,5000,10000,15000,20000,25000,30000,35000,40000)) # Para todo el pais
View(map)
library(readr)
library(ggplot2)
library(disk.frame)
library(dplyr)
library(purrr)
homicide_route <- "../Homicidio.csv/verdata-homicidio-R99.csv"
kidnapping_route <- "../Secuestro.csv/verdata-secuestro-R99.csv"
disappearances_route <- "../Desaparicion.csv/verdata-desaparicion-R99.csv"
recruitment_route <-"../Reclutamiento.csv/verdata-reclutamiento-R99.csv"
homicide1df <-read.csv(homicide_route)
kidnapping1df <-read.csv(kidnapping_route)
recruitment1df <-read.csv(recruitment_route)
disappearance1df <-read.csv(disappearances_route)
#exploracion de datos
print(any(is.na(homicide1df)))
print(all(apply(homicide1df,2,function(x) all(!is.nan(x)))))
print(all(apply(kidnapping1df,2,function(x) all(!is.nan(x)))))
print(any(is.na(kidnapping1df)))
print(any(is.na(recruitment1df)))
print(all(apply(recruitment1df,2,function(x) all(!is.nan(x)))))
print(all(apply(disappearance1df,2,function(x) all(!is.nan(x)))))
print(any(is.na(disappearance1df)))
library(sf)
library(tmap)
library(readr)
library(ggplot2)
library(disk.frame)
library(dplyr)
library(purrr)
library(readr)
library(ggplot2)
library(disk.frame)
library(dplyr)
library(purrr)
#revisar si el id conecta diferentes hechos
valores_comunes <- homicide1df$match_group_id %in% kidnapping1df$match_group_id
valores_comunes2 <- intersect(homicide1df$match_group_id, kidnapping1df$match_group_id)
print(any(valores_comunes))
print(valores_comunes2)
fila_deseada <- filter(kidnapping1df,match_group_id=="af42ca884de6db37305fa0ed47cb82a50f523aea")
#volver caracter la columna de departamentos y municipios y concatenar un cero a la izquierda para poder luego usar map
#quitar columnas no deseadas
#homicide
homicide1df <- homicide1df %>% mutate(
dept_code_hecho = ifelse(dept_code_hecho < 10 , sprintf("%02d", dept_code_hecho) %>% as.character(), as.character(dept_code_hecho)),
muni_code_hecho = ifelse(dept_code_hecho < 10 , as.character() %>% paste("0", muni_code_hecho, sep = "") , as.character(muni_code_hecho))
)
homicide1df <-homicide1df[,-c(3:36,1,51)]
#homicide1df$muni_code_hecho <- substr(homicide1df$muni_code_hecho, nchar(homicide1df$muni_code_hecho) - 2, nchar(homicide1df$muni_code_hecho))
#disappearance
disappearance1df <- disappearance1df %>% mutate(
dept_code_hecho = ifelse(dept_code_hecho < 10 , sprintf("%02d", dept_code_hecho) %>% as.character(), as.character(dept_code_hecho)),
muni_code_hecho = ifelse(muni_code_hecho < 10 , sprintf("%02d", muni_code_hecho) %>% as.character(), as.character(muni_code_hecho))
)
disappearance1df <-disappearance1df[,-c(3:36,1,53)]
#disappearance1df$muni_code_hecho <- substr(disappearance1df$muni_code_hecho, nchar(disappearance1df$muni_code_hecho) - 2, nchar(disappearance1df$muni_code_hecho))
#kidnapping
kidnapping1df <- kidnapping1df %>% mutate(
dept_code_hecho = ifelse(dept_code_hecho < 10 , sprintf("%02d", dept_code_hecho) %>% as.character(), as.character(dept_code_hecho)),
muni_code_hecho = ifelse(muni_code_hecho < 10 , sprintf("%02d", muni_code_hecho) %>% as.character(), as.character(muni_code_hecho))
)
kidnapping1df <-kidnapping1df[,-c(3:36,1,51)]
#kidnapping1df$muni_code_hecho <- substr(kidnapping1df$muni_code_hecho, nchar(kidnapping1df$muni_code_hecho) - 2, nchar(kidnapping1df$muni_code_hecho))
#recruitment
recruitment1df <- recruitment1df %>% mutate(
dept_code_hecho = ifelse(dept_code_hecho < 10 , sprintf("%02d", dept_code_hecho) %>% as.character(), as.character(dept_code_hecho)),
muni_code_hecho = ifelse(muni_code_hecho < 10 , sprintf("%02d", muni_code_hecho) %>% as.character(), as.character(muni_code_hecho))
)
recruitment1df <-recruitment1df[,-c(3:36,1,51)]
#recruitment1df$muni_code_hecho <- substr(recruitment1df$muni_code_hecho, nchar(recruitment1df$muni_code_hecho) - 2, nchar(recruitment1df$muni_code_hecho))
#aplicando las funciones de dplyr para un data frame
#datos por municipio
homicides_group_year_mun <- homicide1df %>%
group_by(yy_hecho,muni_code_hecho, dept_code_hecho) %>%
summarise(n=n())
homicides_group_mun <- homicide1df %>%
group_by(muni_code_hecho) %>%
summarise(n=n())
# datos por año
disappearance_per_year <- disappearance1df%>%
group_by(yy_hecho) %>%
summarise(n=n())
homicides_per_year <- homicide1df%>%
group_by(yy_hecho) %>%
summarise(n=n())
kidnapping_per_year <- kidnapping1df%>%
group_by(yy_hecho) %>%
summarise(n=n())
recruitment_per_year <- recruitment1df%>%
group_by(yy_hecho) %>%
summarise(n=n())
#datos por grupo
homicides_per_group <- homicide1df %>%
mutate(Grupo = case_when(
grepl("GUE",p_str) ~ "GUERRILLA",
grepl("PARA",p_str) ~ "PARAMILITARES",
grepl("EST",p_str) ~ "ESTADO",
grepl("multiple",p_str) ~ "MULTIPLE",
TRUE ~ "OTRO"
)) %>%
group_by(yy_hecho,Grupo) %>%
summarise(n=n())
kidnapping_per_group <- kidnapping1df %>%
mutate(Grupo = case_when(
grepl("GUE",p_str) ~ "GUERRILLA",
grepl("PARA",p_str) ~ "PARAMILITARES",
grepl("EST",p_str) ~ "ESTADO",
grepl("multiple",p_str) ~ "MULTIPLE",
TRUE ~ "OTRO"
)) %>%
group_by(yy_hecho,Grupo) %>%
summarise(n=n())
#secuestros que llevan a homicidios
kidnapp_homicidie <-inner_join(homicide1df, kidnapping1df, by = "match_group_id")
kidnapping_homicide_per_group <- kidnapp_homicidie %>%
mutate(Grupo = case_when(
grepl("GUE",p_str.x) ~ "GUERRILLA",
grepl("PARA",p_str.x) ~ "PARAMILITARES",
grepl("EST",p_str.x) ~ "ESTADO",
grepl("multiple",p_str.x) ~ "MULTIPLE",
TRUE ~ "OTRO"
)) %>%
group_by(yy_hecho.x,Grupo) %>%
summarise(n=n())
map <- st_read("Mapas_mun/MunicipiosVeredas.shp")
homicides_group_mun$DPTOMPIO<-factor(homicides_group_mun$muni_code_hecho)
homicides_group_mun$muni_code_hecho<-NULL
homicides_group_mun$homicidios<-homicides_group_mun$n
homicides_group_mun$n<-NULL
map <- map[,c(1,2,3)]
map <- left_join(map, homicides_group_mun)
qtm(map,"homicidios", fill.breaks = c(0,1000,5000,10000,15000,20000,25000,30000,35000,40000)) # Para todo el pais
# PLOTS PER_YEAR
#plot total per year
ggplot(homicides_per_year, aes(x = yy_hecho, y = n, color = "homicidios")) +
geom_line(size =0.8) +
geom_line(data = disappearance_per_year, aes(x = yy_hecho, y = n, color = "desapariciones"),size=0.8)+
geom_line(data = kidnapping_per_year, aes(x = yy_hecho, y = n, color = "secuestros"),size=0.8)+
geom_line(data = recruitment_per_year, aes(x = yy_hecho, y = n, color = "reclutamiento"),size=0.8)+
labs(title = "Número de hechos por año",
x = "Año",
y = "Número de hechos",
color = "tipo de hecho") +
theme_light() +
scale_x_continuous(breaks = seq(min(homicides_per_year$yy_hecho), max(homicides_per_year$yy_hecho), by = 1))
#plot homicides_per_year
ggplot(homicides_per_year, aes(x = yy_hecho, y = n)) +
geom_line(color = "blue") +
geom_point(color = "red") +
labs(title = "Tendencia de Homicidios por Año",
x = "Año",
y = "Número de Homicidios") +
theme_minimal() +
scale_y_continuous(limits = c(0, max(homicides_per_year$n) + 1000), breaks = seq(0, max(homicides_per_year$n) + 1000, by = 1000)) +
scale_x_continuous(breaks = seq(min(homicides_per_year$yy_hecho), max(homicides_per_year$yy_hecho), by = 1))
#PLOT PER GROUP
#plot homicides_per_group
ggplot(homicides_per_group, aes(x = yy_hecho, y = n, color = Grupo)) +
geom_line(size =0.8) +
geom_line(data = homicides_per_year, aes(x = yy_hecho, y = n, color = "TOTAL"), color="black")+
labs(title = "Número de Homicidios por Año y Grupo",
x = "Año",
y = "Número de Homicidios",
color = "Grupo") +
theme_light() +
scale_x_continuous(breaks = seq(min(homicides_per_group$yy_hecho), max(homicides_per_group$yy_hecho), by = 1))
ggplot(kidnapping_per_group, aes(x = yy_hecho, y = n, color = Grupo)) +
geom_line(size =0.8) +
geom_line(data = kidnapping_per_year, aes(x = yy_hecho, y = n, color = "TOTAL"), color="black")+
labs(title = "Número de secuestros por Año y Grupo",
x = "Año",
y = "Número de secuestros",
color = "Grupo") +
theme_light() +
scale_x_continuous(breaks = seq(min(kidnapping_per_group$yy_hecho), max(kidnapping_per_group$yy_hecho), by = 1))
library(readr)
library(ggplot2)
library(disk.frame)
library(dplyr)
homicide_route <- "../Homicidio.csv/verdata-homicidio-R99.csv"
kidnapping_route <- "../Secuestro.csv/verdata-secuestro-R99.csv"
disappearances_route <- "../Desaparicion.csv/verdata-desaparicion-R99.csv"
recruitment_route <-"../Reclutamiento.csv/verdata-reclutamiento-R99.csv"
homicide1df <-read.csv(homicide_route)
kidnapping1df <-read.csv(kidnapping_route)
recruitment1df <-read.csv(recruitment_route)
disappearance1df <-read.csv(disappearances_route)
#exploracion de datos
print(any(is.na(homicide1df)))
print(all(apply(homicide1df,2,function(x) all(!is.nan(x)))))
print(all(apply(kidnapping1df,2,function(x) all(!is.nan(x)))))
print(any(is.na(kidnapping1df)))
print(any(is.na(recruitment1df)))
print(all(apply(recruitment1df,2,function(x) all(!is.nan(x)))))
print(all(apply(disappearance1df,2,function(x) all(!is.nan(x)))))
print(any(is.na(disappearance1df)))
library(readr)
library(ggplot2)
library(disk.frame)
library(dplyr)
library(sf)
library(tmap)
library(readr)
library(ggplot2)
library(disk.frame)
library(dplyr)
View(homicide1df)
#homicide
homicide1df <- homicide1df %>% mutate(
dept_code_hecho = ifelse(dept_code_hecho < 10 , sprintf("%02d", dept_code_hecho) %>% as.character(), as.character(dept_code_hecho)),
muni_code_hecho = ifelse(dept_code_hecho < 10 , as.character() %>% paste("0", muni_code_hecho, sep = "") , as.character(muni_code_hecho))
)
library(readr)
library(ggplot2)
library(disk.frame)
library(dplyr)
library(purrr)
homicide1df <- homicide1df %>% mutate(
dept_code_hecho = ifelse(dept_code_hecho < 10 , sprintf("%02d", dept_code_hecho) %>% as.character(), as.character(dept_code_hecho)),
muni_code_hecho = ifelse(dept_code_hecho < 10 , as.character() %>% paste("0", muni_code_hecho, sep = "") , as.character(muni_code_hecho))
)
homicide1df <-homicide1df[,-c(3:36,38:45,1,51,47,49:51,53 )]
View(homicide1df)
View(homicide1df)
View(disappearance1df)
library(readr)
library(ggplot2)
library(disk.frame)
library(dplyr)
library(purrr)
#Importar archivos csv
#ruta de los archivos
homicide_route <- "../Homicidio.csv/verdata-homicidio-R99.csv"
kidnapping_route <- "../Secuestro.csv/verdata-secuestro-R99.csv"
disappearances_route <- "../Desaparicion.csv/verdata-desaparicion-R99.csv"
recruitment_route <-"../Reclutamiento.csv/verdata-reclutamiento-R99.csv"
#Leer csv
homicide1df <-read.csv(homicide_route)
kidnapping1df <-read.csv(kidnapping_route)
recruitment1df <-read.csv(recruitment_route)
disappearance1df <-read.csv(disappearances_route)
#exploracion de datos
#revisar si hay campos na en los datafrmaes
print(any(is.na(homicide1df)))
#revisar si hay campos nan en los dataframes
print(all(apply(homicide1df,2,function(x) all(!is.nan(x)))))
print(all(apply(kidnapping1df,2,function(x) all(!is.nan(x)))))
print(any(is.na(kidnapping1df)))
print(any(is.na(recruitment1df)))
print(all(apply(recruitment1df,2,function(x) all(!is.nan(x)))))
print(all(apply(disappearance1df,2,function(x) all(!is.nan(x)))))
print(any(is.na(disappearance1df)))
library(readr)
library(ggplot2)
library(disk.frame)
library(dplyr)
library(purrr)
#revisar si el id conecta diferentes hechos
valores_comunes <- homicide1df$match_group_id %in% kidnapping1df$match_group_id
valores_comunes2 <- intersect(homicide1df$match_group_id, kidnapping1df$match_group_id)
print(any(valores_comunes))
print(valores_comunes2)
fila_deseada <- filter(kidnapping1df,match_group_id=="af42ca884de6db37305fa0ed47cb82a50f523aea")
#volver caracter la columna de departamentos y municipios y concatenar un cero a la izquierda para poder luego usar map
#quitar columnas no deseadas
#homicide
homicide1df <- homicide1df %>% mutate(
dept_code_hecho = ifelse(dept_code_hecho < 10 , sprintf("%02d", dept_code_hecho) %>% as.character(), as.character(dept_code_hecho)),
muni_code_hecho = ifelse(dept_code_hecho < 10 , as.character() %>% paste("0", muni_code_hecho, sep = "") , as.character(muni_code_hecho))
)
homicide1df <-homicide1df[,-c(3:36,38:45,1,51,47,49:51,53 )]
#homicide1df$muni_code_hecho <- substr(homicide1df$muni_code_hecho, nchar(homicide1df$muni_code_hecho) - 2, nchar(homicide1df$muni_code_hecho))
#disappearance
disappearance1df <- disappearance1df %>% mutate(
dept_code_hecho = ifelse(dept_code_hecho < 10 , sprintf("%02d", dept_code_hecho) %>% as.character(), as.character(dept_code_hecho)),
muni_code_hecho = ifelse(muni_code_hecho < 10 , sprintf("%02d", muni_code_hecho) %>% as.character(), as.character(muni_code_hecho))
)
disappearance1df <-disappearance1df[,-c(3:36,1,38:47,49,51:53,54)]
#disappearance1df$muni_code_hecho <- substr(disappearance1df$muni_code_hecho, nchar(disappearance1df$muni_code_hecho) - 2, nchar(disappearance1df$muni_code_hecho))
#kidnapping
kidnapping1df <- kidnapping1df %>% mutate(
dept_code_hecho = ifelse(dept_code_hecho < 10 , sprintf("%02d", dept_code_hecho) %>% as.character(), as.character(dept_code_hecho)),
muni_code_hecho = ifelse(muni_code_hecho < 10 , sprintf("%02d", muni_code_hecho) %>% as.character(), as.character(muni_code_hecho))
)
kidnapping1df <-kidnapping1df[,-c(3:36,38:45,1,51,47,49:51,53 )]
#kidnapping1df$muni_code_hecho <- substr(kidnapping1df$muni_code_hecho, nchar(kidnapping1df$muni_code_hecho) - 2, nchar(kidnapping1df$muni_code_hecho))
#recruitment
recruitment1df <- recruitment1df %>% mutate(
dept_code_hecho = ifelse(dept_code_hecho < 10 , sprintf("%02d", dept_code_hecho) %>% as.character(), as.character(dept_code_hecho)),
muni_code_hecho = ifelse(muni_code_hecho < 10 , sprintf("%02d", muni_code_hecho) %>% as.character(), as.character(muni_code_hecho))
)
recruitment1df <-recruitment1df[,-c(3:36,38:45,1,51,47,49:51,53 )]
#recruitment1df$muni_code_hecho <- substr(recruitment1df$muni_code_hecho, nchar(recruitment1df$muni_code_hecho) - 2, nchar(recruitment1df$muni_code_hecho))
View(recruitment1df)
View(recruitment1df)
View(kidnapping1df)
View(kidnapping1df)
View(homicide1df)
View(homicide1df)
View(fila_deseada)
View(disappearance1df)
View(disappearance1df)
library(readr)
library(ggplot2)
library(disk.frame)
library(dplyr)
library(purrr)
#Importar archivos csv
#ruta de los archivos
homicide_route <- "../Homicidio.csv/verdata-homicidio-R99.csv"
kidnapping_route <- "../Secuestro.csv/verdata-secuestro-R99.csv"
disappearances_route <- "../Desaparicion.csv/verdata-desaparicion-R99.csv"
recruitment_route <-"../Reclutamiento.csv/verdata-reclutamiento-R99.csv"
#Leer csv
homicide1df <-read.csv(homicide_route)
kidnapping1df <-read.csv(kidnapping_route)
recruitment1df <-read.csv(recruitment_route)
disappearance1df <-read.csv(disappearances_route)
#exploracion de datos
#revisar si hay campos na en los datafrmaes
print(any(is.na(homicide1df)))
#revisar si hay campos nan en los dataframes
print(all(apply(homicide1df,2,function(x) all(!is.nan(x)))))
print(all(apply(kidnapping1df,2,function(x) all(!is.nan(x)))))
print(any(is.na(kidnapping1df)))
print(any(is.na(recruitment1df)))
print(all(apply(recruitment1df,2,function(x) all(!is.nan(x)))))
print(all(apply(disappearance1df,2,function(x) all(!is.nan(x)))))
print(any(is.na(disappearance1df)))
library(readr)
library(ggplot2)
library(disk.frame)
library(dplyr)
library(purrr)
#revisar si el id conecta diferentes hechos
valores_comunes <- homicide1df$match_group_id %in% kidnapping1df$match_group_id
print(any(valores_comunes)) #mostrar si existen filas con la misma id en los df
#generar una lista de filas  en comun
valores_comunes2 <- intersect(homicide1df$match_group_id, kidnapping1df$match_group_id)
#comprobar
print(valores_comunes2)
fila_deseada <- filter(kidnapping1df,match_group_id=="af42ca884de6db37305fa0ed47cb82a50f523aea")
#volver caracter la columna de departamentos y municipios y concatenar un cero a la izquierda para poder luego usar map
#quitar columnas no deseadas
#homicide
#aplicando mutate para cambiar el tipo de variable
homicide1df <- homicide1df %>% mutate(
dept_code_hecho = ifelse(dept_code_hecho < 10 , sprintf("%02d", dept_code_hecho) %>% as.character(), as.character(dept_code_hecho)),
muni_code_hecho = ifelse(dept_code_hecho < 10 , as.character() %>% paste("0", muni_code_hecho, sep = "") , as.character(muni_code_hecho))
)
#eliminando columnas
homicide1df <-homicide1df[,-c(3:36,38:45,1,51,47,49:51,53 )]
#homicide1df$muni_code_hecho <- substr(homicide1df$muni_code_hecho, nchar(homicide1df$muni_code_hecho) - 2, nchar(homicide1df$muni_code_hecho))
#disappearance
disappearance1df <- disappearance1df %>% mutate(
dept_code_hecho = ifelse(dept_code_hecho < 10 , sprintf("%02d", dept_code_hecho) %>% as.character(), as.character(dept_code_hecho)),
muni_code_hecho = ifelse(muni_code_hecho < 10 , sprintf("%02d", muni_code_hecho) %>% as.character(), as.character(muni_code_hecho))
)
disappearance1df <-disappearance1df[,-c(3:36,1,38:47,49,51:53,54)]
#disappearance1df$muni_code_hecho <- substr(disappearance1df$muni_code_hecho, nchar(disappearance1df$muni_code_hecho) - 2, nchar(disappearance1df$muni_code_hecho))
#kidnapping
kidnapping1df <- kidnapping1df %>% mutate(
dept_code_hecho = ifelse(dept_code_hecho < 10 , sprintf("%02d", dept_code_hecho) %>% as.character(), as.character(dept_code_hecho)),
muni_code_hecho = ifelse(muni_code_hecho < 10 , sprintf("%02d", muni_code_hecho) %>% as.character(), as.character(muni_code_hecho))
)
kidnapping1df <-kidnapping1df[,-c(3:36,38:45,1,51,47,49:51,53 )]
#kidnapping1df$muni_code_hecho <- substr(kidnapping1df$muni_code_hecho, nchar(kidnapping1df$muni_code_hecho) - 2, nchar(kidnapping1df$muni_code_hecho))
#recruitment
recruitment1df <- recruitment1df %>% mutate(
dept_code_hecho = ifelse(dept_code_hecho < 10 , sprintf("%02d", dept_code_hecho) %>% as.character(), as.character(dept_code_hecho)),
muni_code_hecho = ifelse(muni_code_hecho < 10 , sprintf("%02d", muni_code_hecho) %>% as.character(), as.character(muni_code_hecho))
)
recruitment1df <-recruitment1df[,-c(3:36,38:45,1,51,47,49:51,53 )]
#recruitment1df$muni_code_hecho <- substr(recruitment1df$muni_code_hecho, nchar(recruitment1df$muni_code_hecho) - 2, nchar(recruitment1df$muni_code_hecho))
#aplicando las funciones de dplyr para un data frame
#datos por municipio
homicides_group_year_mun <- homicide1df %>%
group_by(yy_hecho,muni_code_hecho, dept_code_hecho) %>%
summarise(n=n())
homicides_group_mun <- homicide1df %>%
group_by(muni_code_hecho) %>%
summarise(n=n())
# datos por año
disappearance_per_year <- disappearance1df%>%
group_by(yy_hecho) %>%
summarise(n=n())
