replace_na(replace= list(n.x.x =0 , n.y.y=0 , n.x=0, n.y=0)) %>% #reemplazar por cero los valores NA
mutate(total=rowSums(select(., starts_with("n")))) #sumar los hechos
total_per_year <-total_per_year[,-c(2:5)] #eliminar las columnas sobrantes
####
#datos por grupo
homicides_per_group <- homicide1df %>%
mutate(Grupo = case_when(
grepl("GUE",p_str) ~ "GUERRILLA",
grepl("PARA",p_str) ~ "PARAMILITARES",
grepl("EST",p_str) ~ "ESTADO",
grepl("multiple",p_str) ~ "MULTIPLE",
TRUE ~ "OTRO"
)) %>%
group_by(yy_hecho,Grupo) %>%
summarise(n=n())
kidnapping_per_group <- kidnapping1df %>%
mutate(Grupo = case_when(
grepl("GUE",p_str) ~ "GUERRILLA",
grepl("PARA",p_str) ~ "PARAMILITARES",
grepl("EST",p_str) ~ "ESTADO",
grepl("multiple",p_str) ~ "MULTIPLE",
TRUE ~ "OTRO"
)) %>%
group_by(yy_hecho,Grupo) %>%
summarise(n=n())
disappearance_per_group <- disappearance1df %>%
mutate(Grupo = case_when(
grepl("GUE",p_str) ~ "GUERRILLA",
grepl("PARA",p_str) ~ "PARAMILITARES",
grepl("EST",p_str) ~ "ESTADO",
grepl("multiple",p_str) ~ "MULTIPLE",
TRUE ~ "OTRO"
)) %>%
group_by(yy_hecho,Grupo) %>%
summarise(n=n())
#secuestros que llevan a homicidios
kidnapp_homicidie <-inner_join(homicide1df, kidnapping1df, by = "match_group_id")
kidnapping_homicide_per_group <- kidnapp_homicidie %>%
mutate(Grupo = case_when(
grepl("GUE",p_str.x) ~ "GUERRILLA",
grepl("PARA",p_str.x) ~ "PARAMILITARES",
grepl("EST",p_str.x) ~ "ESTADO",
grepl("multiple",p_str.x) ~ "MULTIPLE",
TRUE ~ "OTRO"
)) %>%
group_by(yy_hecho.x,Grupo) %>%
summarise(n=n())
View(homicides_per_group_dept)
homicides_per_group_dept <- homicide1df %>%
mutate(Grupo = case_when(
grepl("GUE",p_str) ~ "GUERRILLA",
grepl("PARA",p_str) ~ "PARAMILITARES",
grepl("EST",p_str) ~ "ESTADO",
grepl("multiple",p_str) ~ "MULTIPLE",
TRUE ~ "OTRO"
)) %>%
filter(!grepl("OTRO",Grupo, ignore.case = TRUE)) %>%
filter(!grepl("ESTADO",Grupo, ignore.case = TRUE)) %>%
filter(!grepl("MULTIPLE",Grupo, ignore.case = TRUE)) %>%
group_by(Grupo,dept_code_hecho) %>%
summarise(n=n()) %>%
group_by(dept_code_hecho) %>%
top_n(1, wt = n)
homicides_group_dept <-homicides_per_group_dept[,-c(3)]
library(sf)
library(tmap)
library(readr)
library(ggplot2)
library(disk.frame)
library(dplyr)
library(purrr)
#mapa homicidios historico por municipio
map <- st_read("Mapas_dept/DepartamentosVeredas.shp")
homicides_group_dept$DPTO_CCDGO<-factor(homicides_group_dept$dept_code_hecho)
homicides_group_dept$dept_code_hecho<-NULL
homicides_group_dept$homicidios<-homicides_group_dept$n
homicides_group_dept$n<-NULL
map <- map[,c(1,2)]
map <- left_join(map, homicides_group_dept)
summary(map)
homicides_per_group_dept <- homicide1df %>%
mutate(Grupo = case_when(
grepl("GUE",p_str) ~ "GUERRILLA",
grepl("PARA",p_str) ~ "PARAMILITARES",
grepl("EST",p_str) ~ "ESTADO",
grepl("multiple",p_str) ~ "MULTIPLE",
TRUE ~ "OTRO"
)) %>%
filter(!grepl("OTRO",Grupo, ignore.case = TRUE)) %>%
filter(!grepl("ESTADO",Grupo, ignore.case = TRUE)) %>%
filter(!grepl("MULTIPLE",Grupo, ignore.case = TRUE)) %>%
group_by(Grupo,dept_code_hecho) %>%
summarise(n=n()) %>%
group_by(dept_code_hecho) %>%
top_n(1, wt = n)
homicides_group_dept <-homicides_per_group_dept[2,1]
View(homicides_per_group_dept)
homicides_per_group_dept <- homicide1df %>%
mutate(Grupo = case_when(
grepl("GUE",p_str) ~ "GUERRILLA",
grepl("PARA",p_str) ~ "PARAMILITARES",
grepl("EST",p_str) ~ "ESTADO",
grepl("multiple",p_str) ~ "MULTIPLE",
TRUE ~ "OTRO"
)) %>%
filter(!grepl("OTRO",Grupo, ignore.case = TRUE)) %>%
filter(!grepl("ESTADO",Grupo, ignore.case = TRUE)) %>%
filter(!grepl("MULTIPLE",Grupo, ignore.case = TRUE)) %>%
group_by(Grupo,dept_code_hecho) %>%
summarise(n=n()) %>%
group_by(dept_code_hecho) %>%
top_n(1, wt = n)
homicides_group_dept <-homicides_per_group_dept[,-c(3)]
map2 <- st_read("Mapas_dept/DepartamentosVeredas.shp")
homicides_per_group_dept$DPTO_CCDGO<-factor(homicides_per_group_dept$dept_code_hecho)
homicides_per_group_dept$dept_code_hecho<-NULL
homicides_per_group_dept$Grupo_ar<-homicides_per_group_dept$Grupo
homicides_per_group_dept$Grupo<-NULL
map2 <- map2[,c(1,2)]
map2 <- left_join(map2, homicides_per_group_dept)
tm_shape(map2) +
tm_borders() +
tm_fill("Grupo_ar", palette = "Set3") +
tm_layout(legend.position = c("right", "bottom"))
#mapa homicidios historico por municipio
map <- st_read("Mapas_dept/DepartamentosVeredas.shp") #cargar el mapa
library(sf)  #Leer los archivos pertinentes para la creación de mapas
library(tmap) #Trabajar con mapas
library(readr) #leer y escribir archivos tipo csv
library(ggplot2) #Realizar gráficas
library(dplyr) #poder realizar operaciones sobre dataframes de manera simple
library(tidyr) #poder cambiar valores NA por cero en un dataframe
library(purrr) #poder trabajar con dataframes usando la funcion reduce
#Importar archivos csv
#ruta de los archivos
homicide_route <- "../Homicidio.csv/verdata-homicidio-R99.csv"
kidnapping_route <- "../Secuestro.csv/verdata-secuestro-R99.csv"
disappearances_route <- "../Desaparicion.csv/verdata-desaparicion-R99.csv"
recruitment_route <-"../Reclutamiento.csv/verdata-reclutamiento-R99.csv"
#Leer csv
homicide1df <-read.csv(homicide_route)
kidnapping1df <-read.csv(kidnapping_route)
recruitment1df <-read.csv(recruitment_route)
disappearance1df <-read.csv(disappearances_route)
#homicide
#aplicando mutate para cambiar el tipo de variable
homicide1df <- homicide1df %>% mutate(
dept_code_hecho = ifelse(dept_code_hecho < 10 , sprintf("%02d", dept_code_hecho) %>% as.character(), as.character(dept_code_hecho)),
muni_code_hecho = ifelse(dept_code_hecho < 10 , as.character() %>% paste("0", muni_code_hecho, sep = "") , as.character(muni_code_hecho))
)
#eliminando columnas
homicide1df <-homicide1df[,-c(3:36,38:45,1,51,47,49:51,53 )]
#homicide1df$muni_code_hecho <- substr(homicide1df$muni_code_hecho, nchar(homicide1df$muni_code_hecho) - 2, nchar(homicide1df$muni_code_hecho))
#disappearance
disappearance1df <- disappearance1df %>% mutate(
dept_code_hecho = ifelse(dept_code_hecho < 10 , sprintf("%02d", dept_code_hecho) %>% as.character(), as.character(dept_code_hecho)),
muni_code_hecho = ifelse(muni_code_hecho < 10 , sprintf("%02d", muni_code_hecho) %>% as.character(), as.character(muni_code_hecho))
)
disappearance1df <-disappearance1df[,-c(3:36,1,38:47,49,51:53,55)]
#disappearance1df$muni_code_hecho <- substr(disappearance1df$muni_code_hecho, nchar(disappearance1df$muni_code_hecho) - 2, nchar(disappearance1df$muni_code_hecho))
#kidnapping
kidnapping1df <- kidnapping1df %>% mutate(
dept_code_hecho = ifelse(dept_code_hecho < 10 , sprintf("%02d", dept_code_hecho) %>% as.character(), as.character(dept_code_hecho)),
muni_code_hecho = ifelse(muni_code_hecho < 10 , sprintf("%02d", muni_code_hecho) %>% as.character(), as.character(muni_code_hecho))
)
kidnapping1df <-kidnapping1df[,-c(3:36,38:45,1,51,47,49:51,53 )]
#kidnapping1df$muni_code_hecho <- substr(kidnapping1df$muni_code_hecho, nchar(kidnapping1df$muni_code_hecho) - 2, nchar(kidnapping1df$muni_code_hecho))
#recruitment
recruitment1df <- recruitment1df %>% mutate(
dept_code_hecho = ifelse(dept_code_hecho < 10 , sprintf("%02d", dept_code_hecho) %>% as.character(), as.character(dept_code_hecho)),
muni_code_hecho = ifelse(muni_code_hecho < 10 , sprintf("%02d", muni_code_hecho) %>% as.character(), as.character(muni_code_hecho))
)
recruitment1df <-recruitment1df[,-c(3:36,38:45,1,51,47,49:51,53 )]
#recruitment1df$muni_code_hecho <- substr(recruitment1df$muni_code_hecho, nchar(recruitment1df$muni_code_hecho) - 2, nchar(recruitment1df$muni_code_hecho))
knitr::kable(
head(homicide1df),
caption = "Registros de homicidios en el marco del conflicto armado",
format = "html",
table.attr = 'class="table table-striped table-bordered"',
align = "c",
)
```
library(sf)  #Leer los archivos pertinentes para la creación de mapas
library(tmap) #Trabajar con mapas
library(readr) #leer y escribir archivos tipo csv
library(ggplot2) #Realizar gráficas
library(dplyr) #poder realizar operaciones sobre dataframes de manera simple
library(tidyr) #poder cambiar valores NA por cero en un dataframe
library(purrr) #poder trabajar con dataframes usando la funcion reduce
#Importar archivos csv
#ruta de los archivos
homicide_route <- "../Homicidio.csv/verdata-homicidio-R99.csv"
kidnapping_route <- "../Secuestro.csv/verdata-secuestro-R99.csv"
disappearances_route <- "../Desaparicion.csv/verdata-desaparicion-R99.csv"
recruitment_route <-"../Reclutamiento.csv/verdata-reclutamiento-R99.csv"
#Leer csv
homicide1df <-read.csv(homicide_route)
kidnapping1df <-read.csv(kidnapping_route)
recruitment1df <-read.csv(recruitment_route)
disappearance1df <-read.csv(disappearances_route)
#homicide
#aplicando mutate para cambiar el tipo de variable
homicide1df <- homicide1df %>% mutate(
dept_code_hecho = ifelse(dept_code_hecho < 10 , sprintf("%02d", dept_code_hecho) %>% as.character(), as.character(dept_code_hecho)),
muni_code_hecho = ifelse(dept_code_hecho < 10 , as.character() %>% paste("0", muni_code_hecho, sep = "") , as.character(muni_code_hecho))
)
#eliminando columnas
homicide1df <-homicide1df[,-c(3:36,38:45,1,51,47,49:51,53 )]
#homicide1df$muni_code_hecho <- substr(homicide1df$muni_code_hecho, nchar(homicide1df$muni_code_hecho) - 2, nchar(homicide1df$muni_code_hecho))
#disappearance
disappearance1df <- disappearance1df %>% mutate(
dept_code_hecho = ifelse(dept_code_hecho < 10 , sprintf("%02d", dept_code_hecho) %>% as.character(), as.character(dept_code_hecho)),
muni_code_hecho = ifelse(muni_code_hecho < 10 , sprintf("%02d", muni_code_hecho) %>% as.character(), as.character(muni_code_hecho))
)
disappearance1df <-disappearance1df[,-c(3:36,1,38:47,49,51:53,55)]
#disappearance1df$muni_code_hecho <- substr(disappearance1df$muni_code_hecho, nchar(disappearance1df$muni_code_hecho) - 2, nchar(disappearance1df$muni_code_hecho))
#kidnapping
kidnapping1df <- kidnapping1df %>% mutate(
dept_code_hecho = ifelse(dept_code_hecho < 10 , sprintf("%02d", dept_code_hecho) %>% as.character(), as.character(dept_code_hecho)),
muni_code_hecho = ifelse(muni_code_hecho < 10 , sprintf("%02d", muni_code_hecho) %>% as.character(), as.character(muni_code_hecho))
)
kidnapping1df <-kidnapping1df[,-c(3:36,38:45,1,51,47,49:51,53 )]
#kidnapping1df$muni_code_hecho <- substr(kidnapping1df$muni_code_hecho, nchar(kidnapping1df$muni_code_hecho) - 2, nchar(kidnapping1df$muni_code_hecho))
#recruitment
recruitment1df <- recruitment1df %>% mutate(
dept_code_hecho = ifelse(dept_code_hecho < 10 , sprintf("%02d", dept_code_hecho) %>% as.character(), as.character(dept_code_hecho)),
muni_code_hecho = ifelse(muni_code_hecho < 10 , sprintf("%02d", muni_code_hecho) %>% as.character(), as.character(muni_code_hecho))
)
recruitment1df <-recruitment1df[,-c(3:36,38:45,1,51,47,49:51,53 )]
#recruitment1df$muni_code_hecho <- substr(recruitment1df$muni_code_hecho, nchar(recruitment1df$muni_code_hecho) - 2, nchar(recruitment1df$muni_code_hecho))
#homicidios por departamento
homicides_group_dept <- homicide1df %>%
group_by(dept_code_hecho) %>%
summarise(n=n())
homicides_per_group_dept <- homicide1df %>%
mutate(Grupo = case_when(
grepl("GUE",p_str) ~ "GUERRILLA",
grepl("PARA",p_str) ~ "PARAMILITARES",
grepl("EST",p_str) ~ "ESTADO",
grepl("multiple",p_str) ~ "MULTIPLE",
TRUE ~ "OTRO"
)) %>%
filter(!grepl("OTRO",Grupo, ignore.case = TRUE)) %>%
filter(!grepl("ESTADO",Grupo, ignore.case = TRUE)) %>%
filter(!grepl("MULTIPLE",Grupo, ignore.case = TRUE)) %>%
group_by(Grupo,dept_code_hecho) %>%
summarise(n=n()) %>%
group_by(dept_code_hecho) %>%
top_n(1, wt = n)
homicides_group_dept <-homicides_per_group_dept[,-c(3)]
#secuestros por departamento
kidnapp_group_dept <- kidnapping1df %>%
group_by(dept_code_hecho) %>%
summarise(n=n())
kidnapp_per_group_dept <- kidnapping1df %>%
mutate(Grupo = case_when(
grepl("GUE",p_str) ~ "GUERRILLA",
grepl("PARA",p_str) ~ "PARAMILITARES",
grepl("EST",p_str) ~ "ESTADO",
grepl("multiple",p_str) ~ "MULTIPLE",
TRUE ~ "OTRO"
)) %>%
filter(!grepl("OTRO",Grupo, ignore.case = TRUE)) %>%
filter(!grepl("ESTADO",Grupo, ignore.case = TRUE)) %>%
filter(!grepl("MULTIPLE",Grupo, ignore.case = TRUE)) %>%
group_by(Grupo,dept_code_hecho) %>%
summarise(n=n()) %>%
group_by(dept_code_hecho) %>%
top_n(1, wt = n)
kidnapp_per_group_dept <-kidnapp_per_group_dept[,-c(3)]
#reclutamiento
recruitment_group_dept <- recruitment1df %>%
group_by(dept_code_hecho) %>%
summarise(n=n())
#mapa homicidios historico por municipio
map <- st_read("Mapas_dept/DepartamentosVeredas.shp") #cargar el mapa
#Acomodar las columnas del dataframe
homicides_group_dept$DPTO_CCDGO<-factor(homicides_group_dept$dept_code_hecho)
homicides_group_dept$dept_code_hecho<-NULL
homicides_group_dept$homicidios<-homicides_group_dept$n
homicides_group_dept$n<-NULL
map <- map[,c(1,2)]
#unir las coordenadas del mapa con el dataframe
map <- left_join(map, homicides_group_dept)
summary(map)
#graficar
qtm(map,"homicidios", fill.breaks = c(0,15000,25000, 50000,75000,100000,125000,150000))
map2 <- st_read("Mapas_dept/DepartamentosVeredas.shp") #cargar mapas
#Acomodoar columnas
homicides_per_group_dept$DPTO_CCDGO<-factor(homicides_per_group_dept$dept_code_hecho)
homicides_per_group_dept$dept_code_hecho<-NULL
homicides_per_group_dept$Grupo_ar<-homicides_per_group_dept$Grupo
homicides_per_group_dept$Grupo<-NULL
map2 <- map2[,c(1,2)]
map2 <- left_join(map2, homicides_per_group_dept)
#graficar por grupo
tm_shape(map2) +
tm_borders() +
tm_fill("Grupo_ar", palette = "Set3") +
tm_layout(legend.position = c("right", "bottom"))
map3 <- st_read("Mapas_dept/DepartamentosVeredas.shp") #cargar mapa
#acomodar columnas
kidnapp_group_dept$DPTO_CCDGO<-factor(kidnapp_group_dept$dept_code_hecho)
kidnapp_group_dept$dept_code_hecho<-NULL
kidnapp_group_dept$secuestros<-kidnapp_group_dept$n
kidnapp_group_dept$n<-NULL
map3 <- map3[,c(1,2)]
map3 <- left_join(map3, kidnapp_group_dept)
summary(map3)
#graficas
qtm(map3,"secuestros", fill.breaks = c(0,1000,3000, 5000,7000,11000))
map4 <- st_read("Mapas_dept/DepartamentosVeredas.shp") #cargar mapa
#acomodar columnas
kidnapp_per_group_dept$DPTO_CCDGO<-factor(kidnapp_per_group_dept$dept_code_hecho)
kidnapp_per_group_dept$dept_code_hecho<-NULL
kidnapp_per_group_dept$Grupo_ar<-kidnapp_per_group_dept$Grupo
kidnapp_per_group_dept$Grupo<-NULL
map4 <- map4[,c(1,2)]
map4 <- left_join(map4, kidnapp_per_group_dept)
#graficas
tm_shape(map4) +
tm_borders() +
tm_fill("Grupo_ar", palette = "Set3") +
tm_layout(legend.position = c("right", "bottom"))
map5 <- st_read("Mapas_dept/DepartamentosVeredas.shp")
recruitment_group_dept$DPTO_CCDGO<-factor(recruitment_group_dept$dept_code_hecho)
recruitment_group_dept$dept_code_hecho<-NULL
recruitment_group_dept$reclutamiento<-recruitment_group_dept$n
recruitment_group_dept$n<-NULL
map5 <- map5[,c(1,2)]
map5 <- left_join(map5, recruitment_group_dept)
summary(map5)
qtm(map5,"reclutamiento", fill.breaks = c(0,500,1000, 1500,2000,2500,3000,3500))
library(sf)  #Leer los archivos pertinentes para la creación de mapas
library(tmap) #Trabajar con mapas
library(readr) #leer y escribir archivos tipo csv
library(ggplot2) #Realizar gráficas
library(dplyr) #poder realizar operaciones sobre dataframes de manera simple
library(tidyr) #poder cambiar valores NA por cero en un dataframe
library(purrr) #poder trabajar con dataframes usando la funcion reduce
#Importar archivos csv
#ruta de los archivos
homicide_route <- "../Homicidio.csv/verdata-homicidio-R99.csv"
kidnapping_route <- "../Secuestro.csv/verdata-secuestro-R99.csv"
disappearances_route <- "../Desaparicion.csv/verdata-desaparicion-R99.csv"
recruitment_route <-"../Reclutamiento.csv/verdata-reclutamiento-R99.csv"
#Leer csv
homicide1df <-read.csv(homicide_route)
kidnapping1df <-read.csv(kidnapping_route)
recruitment1df <-read.csv(recruitment_route)
disappearance1df <-read.csv(disappearances_route)
#homicide
#aplicando mutate para cambiar el tipo de variable
homicide1df <- homicide1df %>% mutate(
dept_code_hecho = ifelse(dept_code_hecho < 10 , sprintf("%02d", dept_code_hecho) %>% as.character(), as.character(dept_code_hecho)),
muni_code_hecho = ifelse(dept_code_hecho < 10 , as.character() %>% paste("0", muni_code_hecho, sep = "") , as.character(muni_code_hecho))
)
#eliminando columnas
homicide1df <-homicide1df[,-c(3:36,38:45,1,51,47,49:51,53 )]
#homicide1df$muni_code_hecho <- substr(homicide1df$muni_code_hecho, nchar(homicide1df$muni_code_hecho) - 2, nchar(homicide1df$muni_code_hecho))
#disappearance
disappearance1df <- disappearance1df %>% mutate(
dept_code_hecho = ifelse(dept_code_hecho < 10 , sprintf("%02d", dept_code_hecho) %>% as.character(), as.character(dept_code_hecho)),
muni_code_hecho = ifelse(muni_code_hecho < 10 , sprintf("%02d", muni_code_hecho) %>% as.character(), as.character(muni_code_hecho))
)
disappearance1df <-disappearance1df[,-c(3:36,1,38:47,49,51:53,55)]
#disappearance1df$muni_code_hecho <- substr(disappearance1df$muni_code_hecho, nchar(disappearance1df$muni_code_hecho) - 2, nchar(disappearance1df$muni_code_hecho))
#kidnapping
kidnapping1df <- kidnapping1df %>% mutate(
dept_code_hecho = ifelse(dept_code_hecho < 10 , sprintf("%02d", dept_code_hecho) %>% as.character(), as.character(dept_code_hecho)),
muni_code_hecho = ifelse(muni_code_hecho < 10 , sprintf("%02d", muni_code_hecho) %>% as.character(), as.character(muni_code_hecho))
)
kidnapping1df <-kidnapping1df[,-c(3:36,38:45,1,51,47,49:51,53 )]
#kidnapping1df$muni_code_hecho <- substr(kidnapping1df$muni_code_hecho, nchar(kidnapping1df$muni_code_hecho) - 2, nchar(kidnapping1df$muni_code_hecho))
#recruitment
recruitment1df <- recruitment1df %>% mutate(
dept_code_hecho = ifelse(dept_code_hecho < 10 , sprintf("%02d", dept_code_hecho) %>% as.character(), as.character(dept_code_hecho)),
muni_code_hecho = ifelse(muni_code_hecho < 10 , sprintf("%02d", muni_code_hecho) %>% as.character(), as.character(muni_code_hecho))
)
recruitment1df <-recruitment1df[,-c(3:36,38:45,1,51,47,49:51,53 )]
#recruitment1df$muni_code_hecho <- substr(recruitment1df$muni_code_hecho, nchar(recruitment1df$muni_code_hecho) - 2, nchar(recruitment1df$muni_code_hecho))
knitr::kable(
head(homicide1df),
caption = "Registros de homicidios en el marco del conflicto armado",
format = "html",
table.attr = 'class="table table-striped table-bordered"',
align = "c",
)
```
#homicidios por departamento
homicides_group_dept <- homicide1df %>%
group_by(dept_code_hecho) %>%
summarise(n=n())
homicides_per_group_dept <- homicide1df %>%
mutate(Grupo = case_when(
grepl("GUE",p_str) ~ "GUERRILLA",
grepl("PARA",p_str) ~ "PARAMILITARES",
grepl("EST",p_str) ~ "ESTADO",
grepl("multiple",p_str) ~ "MULTIPLE",
TRUE ~ "OTRO"
)) %>%
filter(!grepl("OTRO",Grupo, ignore.case = TRUE)) %>%
filter(!grepl("ESTADO",Grupo, ignore.case = TRUE)) %>%
filter(!grepl("MULTIPLE",Grupo, ignore.case = TRUE)) %>%
group_by(Grupo,dept_code_hecho) %>%
summarise(n=n()) %>%
group_by(dept_code_hecho) %>%
top_n(1, wt = n)
homicides_group_dept <-homicides_per_group_dept[,-c(3)]
#secuestros por departamento
kidnapp_group_dept <- kidnapping1df %>%
group_by(dept_code_hecho) %>%
summarise(n=n())
kidnapp_per_group_dept <- kidnapping1df %>%
mutate(Grupo = case_when(
grepl("GUE",p_str) ~ "GUERRILLA",
grepl("PARA",p_str) ~ "PARAMILITARES",
grepl("EST",p_str) ~ "ESTADO",
grepl("multiple",p_str) ~ "MULTIPLE",
TRUE ~ "OTRO"
)) %>%
filter(!grepl("OTRO",Grupo, ignore.case = TRUE)) %>%
filter(!grepl("ESTADO",Grupo, ignore.case = TRUE)) %>%
filter(!grepl("MULTIPLE",Grupo, ignore.case = TRUE)) %>%
group_by(Grupo,dept_code_hecho) %>%
summarise(n=n()) %>%
group_by(dept_code_hecho) %>%
top_n(1, wt = n)
kidnapp_per_group_dept <-kidnapp_per_group_dept[,-c(3)]
#reclutamiento
recruitment_group_dept <- recruitment1df %>%
group_by(dept_code_hecho) %>%
summarise(n=n())
library(sf)  #Leer los archivos pertinentes para la creación de mapas
library(tmap) #Trabajar con mapas
library(readr) #leer y escribir archivos tipo csv
library(ggplot2) #Realizar gráficas
library(dplyr) #poder realizar operaciones sobre dataframes de manera simple
library(tidyr) #poder cambiar valores NA por cero en un dataframe
library(purrr) #poder trabajar con dataframes usando la funcion reduce
#mapa homicidios historico por municipio
map <- st_read("Mapas_dept/DepartamentosVeredas.shp") #cargar el mapa
#Acomodar las columnas del dataframe
homicides_group_dept$DPTO_CCDGO<-factor(homicides_group_dept$dept_code_hecho)
homicides_group_dept$dept_code_hecho<-NULL
homicides_group_dept$homicidios<-homicides_group_dept$n
homicides_group_dept$n<-NULL
map <- map[,c(1,2)]
#unir las coordenadas del mapa con el dataframe
map <- left_join(map, homicides_group_dept)
summary(map)
#graficar
qtm(map,"homicidios", fill.breaks = c(0,15000,25000, 50000,75000,100000,125000,150000))
qtm(map,"homicidios", fill.breaks = c(0,15000,25000, 50000,75000,100000,125000,150000)) # Para todo el pais
qtm(map,"homicidios", fill.breaks = c(0,15000,25000, 50000,75000,100000,125000,150000)) # Para todo el pais
View(map)
View(map)
library(sf)  #Leer los archivos pertinentes para la creación de mapas
library(tmap) #Trabajar con mapas
library(readr) #leer y escribir archivos tipo csv
library(ggplot2) #Realizar gráficas
library(dplyr) #poder realizar operaciones sobre dataframes de manera simple
library(tidyr) #poder cambiar valores NA por cero en un dataframe
library(purrr) #poder trabajar con dataframes usando la funcion reduce
#Importar archivos csv
#ruta de los archivos
homicide_route <- "../Homicidio.csv/verdata-homicidio-R99.csv"
kidnapping_route <- "../Secuestro.csv/verdata-secuestro-R99.csv"
disappearances_route <- "../Desaparicion.csv/verdata-desaparicion-R99.csv"
recruitment_route <-"../Reclutamiento.csv/verdata-reclutamiento-R99.csv"
#Leer csv
homicide1df <-read.csv(homicide_route)
kidnapping1df <-read.csv(kidnapping_route)
recruitment1df <-read.csv(recruitment_route)
disappearance1df <-read.csv(disappearances_route)
#homicide
#aplicando mutate para cambiar el tipo de variable
homicide1df <- homicide1df %>% mutate(
dept_code_hecho = ifelse(dept_code_hecho < 10 , sprintf("%02d", dept_code_hecho) %>% as.character(), as.character(dept_code_hecho)),
muni_code_hecho = ifelse(dept_code_hecho < 10 , as.character() %>% paste("0", muni_code_hecho, sep = "") , as.character(muni_code_hecho))
)
#eliminando columnas
homicide1df <-homicide1df[,-c(3:36,38:45,1,51,47,49:51,53 )]
#homicide1df$muni_code_hecho <- substr(homicide1df$muni_code_hecho, nchar(homicide1df$muni_code_hecho) - 2, nchar(homicide1df$muni_code_hecho))
#disappearance
disappearance1df <- disappearance1df %>% mutate(
dept_code_hecho = ifelse(dept_code_hecho < 10 , sprintf("%02d", dept_code_hecho) %>% as.character(), as.character(dept_code_hecho)),
muni_code_hecho = ifelse(muni_code_hecho < 10 , sprintf("%02d", muni_code_hecho) %>% as.character(), as.character(muni_code_hecho))
)
disappearance1df <-disappearance1df[,-c(3:36,1,38:47,49,51:53,55)]
#disappearance1df$muni_code_hecho <- substr(disappearance1df$muni_code_hecho, nchar(disappearance1df$muni_code_hecho) - 2, nchar(disappearance1df$muni_code_hecho))
#kidnapping
kidnapping1df <- kidnapping1df %>% mutate(
dept_code_hecho = ifelse(dept_code_hecho < 10 , sprintf("%02d", dept_code_hecho) %>% as.character(), as.character(dept_code_hecho)),
muni_code_hecho = ifelse(muni_code_hecho < 10 , sprintf("%02d", muni_code_hecho) %>% as.character(), as.character(muni_code_hecho))
)
kidnapping1df <-kidnapping1df[,-c(3:36,38:45,1,51,47,49:51,53 )]
#kidnapping1df$muni_code_hecho <- substr(kidnapping1df$muni_code_hecho, nchar(kidnapping1df$muni_code_hecho) - 2, nchar(kidnapping1df$muni_code_hecho))
#recruitment
recruitment1df <- recruitment1df %>% mutate(
dept_code_hecho = ifelse(dept_code_hecho < 10 , sprintf("%02d", dept_code_hecho) %>% as.character(), as.character(dept_code_hecho)),
muni_code_hecho = ifelse(muni_code_hecho < 10 , sprintf("%02d", muni_code_hecho) %>% as.character(), as.character(muni_code_hecho))
)
recruitment1df <-recruitment1df[,-c(3:36,38:45,1,51,47,49:51,53 )]
#recruitment1df$muni_code_hecho <- substr(recruitment1df$muni_code_hecho, nchar(recruitment1df$muni_code_hecho) - 2, nchar(recruitment1df$muni_code_hecho))
knitr::kable(
head(homicide1df),
caption = "Homicidios",
table.attr = 'class="table table-striped table-bordered"',
align = "c",
format = "html"
)
