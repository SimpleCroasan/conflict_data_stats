total_per_year <-total_per_year[,-c(2:5)] #eliminar las columnas sobrantes
####
#datos por grupo
homicides_per_group <- homicide1df %>%
mutate(Grupo = case_when(
grepl("GUE",p_str) ~ "GUERRILLA",
grepl("PARA",p_str) ~ "PARAMILITARES",
grepl("EST",p_str) ~ "ESTADO",
grepl("multiple",p_str) ~ "MULTIPLE",
TRUE ~ "OTRO"
)) %>%
group_by(yy_hecho,Grupo) %>%
summarise(n=n())
kidnapping_per_group <- kidnapping1df %>%
mutate(Grupo = case_when(
grepl("GUE",p_str) ~ "GUERRILLA",
grepl("PARA",p_str) ~ "PARAMILITARES",
grepl("EST",p_str) ~ "ESTADO",
grepl("multiple",p_str) ~ "MULTIPLE",
TRUE ~ "OTRO"
)) %>%
group_by(yy_hecho,Grupo) %>%
summarise(n=n())
disappearance_per_group <- disappearance1df %>%
mutate(Grupo = case_when(
grepl("GUE",p_str) ~ "GUERRILLA",
grepl("PARA",p_str) ~ "PARAMILITARES",
grepl("EST",p_str) ~ "ESTADO",
grepl("multiple",p_str) ~ "MULTIPLE",
TRUE ~ "OTRO"
)) %>%
group_by(yy_hecho,Grupo) %>%
summarise(n=n())
#secuestros que llevan a homicidios
kidnapp_homicidie <-inner_join(homicide1df, kidnapping1df, by = "match_group_id")
kidnapping_homicide_per_group <- kidnapp_homicidie %>%
mutate(Grupo = case_when(
grepl("GUE",p_str.x) ~ "GUERRILLA",
grepl("PARA",p_str.x) ~ "PARAMILITARES",
grepl("EST",p_str.x) ~ "ESTADO",
grepl("multiple",p_str.x) ~ "MULTIPLE",
TRUE ~ "OTRO"
)) %>%
group_by(yy_hecho.x,Grupo) %>%
summarise(n=n())
ggplot(homicides_per_year, aes(x = yy_hecho, y = n, color = "homicidios")) +
geom_line(data = total_per_year, aes(x = yy_hecho, y = total, linetype = "TOTAL"),color="black")+
geom_line(size =0.8) +
geom_line(data = disappearance_per_year, aes(x = yy_hecho, y = n, color = "desapariciones"),size=0.8)+
geom_line(data = kidnapping_per_year, aes(x = yy_hecho, y = n, color = "secuestros"),size=0.8)+
geom_line(data = recruitment_per_year, aes(x = yy_hecho, y = n, color = "reclutamiento"),size=0.8)+
labs(title = "Número de hechos por año",
x = "Año",
y = "Número de hechos",
color = "tipo de hecho") +
theme_light() +
scale_x_continuous(breaks = seq(min(homicides_per_year$yy_hecho), max(homicides_per_year$yy_hecho), by = 3))
#plot homicides_per_year
ggplot(homicides_per_year, aes(x = yy_hecho, y = n)) +
geom_line(color = "blue") +
geom_point(color = "red") +
labs(title = "Tendencia de Homicidios por Año",
x = "Año",
y = "Número de Homicidios") +
theme_minimal() +
scale_y_continuous(limits = c(0, max(homicides_per_year$n) + 1000), breaks = seq(0, max(homicides_per_year$n) + 1000, by = 1000)) +
scale_x_continuous(breaks = seq(min(homicides_per_year$yy_hecho), max(homicides_per_year$yy_hecho), by = 3))
#PLOT PER GROUP
#plot homicides_per_group
ggplot(homicides_per_group, aes(x = yy_hecho, y = n, color = Grupo)) +
geom_line(size =0.8) +
geom_line(data = homicides_per_year, aes(x = yy_hecho, y = n, linetype = "TOTAL"),color="black")+
labs(title = "Número de Homicidios por Año y Grupo",
x = "Año",
y = "Número de Homicidios",
color = "Grupo") +
theme_light() +
scale_x_continuous(breaks = seq(min(homicides_per_group$yy_hecho), max(homicides_per_group$yy_hecho), by = 3))
#plot kidnapping per group
ggplot(kidnapping_per_group, aes(x = yy_hecho, y = n, color = Grupo)) +
geom_line(size =0.8) +
geom_line(data = kidnapping_per_year, aes(x = yy_hecho, y = n, linetype = "TOTAL"), color="black")+
labs(title = "Número de secuestros por Año y Grupo",
x = "Año",
y = "Número de secuestros",
color = "Grupo") +
theme_light() +
scale_x_continuous(breaks = seq(min(kidnapping_per_group$yy_hecho), max(kidnapping_per_group$yy_hecho), by = 3))
#plot disappearence_per_group
ggplot(kidnapping_per_group, aes(x = yy_hecho, y = n, color = Grupo)) +
geom_line(size =0.8) +
geom_line(data = kidnapping_per_year, aes(x = yy_hecho, y = n, linetype = "TOTAL"), color="black")+
labs(title = "Número de secuestros por Año y Grupo",
x = "Año",
y = "Número de secuestros",
color = "Grupo") +
theme_light() +
scale_x_continuous(breaks = seq(min(kidnapping_per_group$yy_hecho), max(kidnapping_per_group$yy_hecho), by = 3))
library(sf)
library(tmap)
library(readr)
library(ggplot2)
library(disk.frame)
library(dplyr)
library(purrr)
ggplot(disappearance_per_group, aes(x = yy_hecho, y = n, color = Grupo)) +
geom_line(size =0.8) +
geom_line(data = disappearance_per_year, aes(x = yy_hecho, y = n, linetype = "TOTAL"),color="black")+
labs(title = "Número de desapariciones por Año y Grupo",
x = "Año",
y = "Número de desapariciones",
ggplot(disappearance_per_group, aes(x = yy_hecho, y = n, color = Grupo)) +
geom_line(size =0.8) +
geom_line(data = disappearance_per_year, aes(x = yy_hecho, y = n, linetype = "TOTAL"),color="black")+
labs(title = "Número de desapariciones por Año y Grupo",
x = "Año",
y = "Número de desapariciones",
ggplot(disappearance_per_group, aes(x = yy_hecho, y = n, color = Grupo)) +
geom_line(size =0.8) +
geom_line(data = disappearance_per_year, aes(x = yy_hecho, y = n, linetype = "TOTAL"),color="black")+
labs(title = "Número de desapariciones por Año y Grupo",
x = "Año",
y = "Número de desapariciones",
summary(map)
library(sf)
library(tmap)
library(readr)
library(ggplot2)
library(disk.frame)
library(dplyr)
library(purrr)
# -*- coding: utf-8 -*-
map <- st_read("Mapas_mun/MunicipiosVeredas.shp")
homicides_group_mun$DPTOMPIO<-factor(homicides_group_mun$muni_code_hecho)
homicides_group_mun$muni_code_hecho<-NULL
homicides_group_mun$homicidios<-homicides_group_mun$n
homicides_group_mun$n<-NULL
map <- map[,c(1,2,3)]
map <- left_join(map, homicides_group_mun)
summary(map)
qtm(map,"homicidios", fill.breaks = c(0,1000,5000,10000,15000,20000,25000,30000,35000,40000)) # Para todo el pais
qtm(map,"homicidios", fill.breaks = c(0,1000,5000,10000,15000,20000,25000,30000,35000,40000,50000)) # Para todo el pais
map2 <- st_read("Mapas_dept/DepartamentosVeredas.shp")
library(sf)
library(tmap)
library(readr)
library(ggplot2)
library(disk.frame)
library(dplyr)
library(purrr)
map2 <- st_read("Mapas_dept/DepartamentosVeredas.shp")
View(map2)
View(homicides_group_mun)
View(homicides_group_year_mun)
homicides_per_group <- homicide1df %>%
mutate(Grupo = case_when(
grepl("GUE",p_str) ~ "GUERRILLA",
grepl("PARA",p_str) ~ "PARAMILITARES",
grepl("EST",p_str) ~ "ESTADO",
grepl("multiple",p_str) ~ "MULTIPLE",
TRUE ~ "OTRO"
)) %>%
filter(!grepl("OTRO",p_str, ignore.case = TRUE)) %>%
group_by(yy_hecho,Grupo) %>%
summarise(n=n())
homicides_per_group_dept <- homicide1df %>%
mutate(Grupo = case_when(
grepl("GUE",p_str) ~ "GUERRILLA",
grepl("PARA",p_str) ~ "PARAMILITARES",
grepl("EST",p_str) ~ "ESTADO",
grepl("multiple",p_str) ~ "MULTIPLE",
TRUE ~ "OTRO"
)) %>%
filter(!grepl("OTRO",p_str, ignore.case = TRUE)) %>%
group_by(yy_hecho,Grupo) %>%
summarise(n=n())
View(homicides_per_group_dept)
View(homicides_per_group_dept)
homicides_per_group_dept <- homicide1df %>%
mutate(Grupo = case_when(
grepl("GUE",p_str) ~ "GUERRILLA",
grepl("PARA",p_str) ~ "PARAMILITARES",
grepl("EST",p_str) ~ "ESTADO",
grepl("multiple",p_str) ~ "MULTIPLE",
TRUE ~ "OTRO"
)) %>%
filter(!grepl("OTRO",p_str, ignore.case = TRUE)) %>%
filter(!grepl("ESTADO",p_str, ignore.case = TRUE)) %>%
filter(!grepl("MULTIPLE",p_str, ignore.case = TRUE)) %>%
group_by(yy_hecho,Grupo) %>%
summarise(n=n())
View(homicides_per_group_dept)
View(homicides_per_group_dept)
homicides_per_group_dept <- homicide1df %>%
mutate(Grupo = case_when(
grepl("GUE",p_str) ~ "GUERRILLA",
grepl("PARA",p_str) ~ "PARAMILITARES",
grepl("EST",p_str) ~ "ESTADO",
grepl("multiple",p_str) ~ "MULTIPLE",
TRUE ~ "OTRO"
)) %>%
filter(!grepl("OTRO",p_str, ignore.case = TRUE)) %>%
filter(!grepl("ESTADO",p_str, ignore.case = TRUE)) %>%
filter(!grepl("MULTIPLE",p_str, ignore.case = TRUE)) %>%
group_by(yy_hecho,Grupo) %>%
summarise(n=n())
View(kidnapping_per_group)
View(homicides_per_group_dept)
homicides_per_group_dept <- homicide1df %>%
mutate(Grupo = case_when(
grepl("GUE",p_str) ~ "GUERRILLA",
grepl("PARA",p_str) ~ "PARAMILITARES",
grepl("EST",p_str) ~ "ESTADO",
grepl("multiple",p_str) ~ "MULTIPLE",
TRUE ~ "OTRO"
)) %>%
filter(!grepl("OTRO",Grupo, ignore.case = TRUE)) %>%
filter(!grepl("ESTADO",Grupo, ignore.case = TRUE)) %>%
filter(!grepl("MULTIPLE",Grupo, ignore.case = TRUE)) %>%
group_by(yy_hecho,Grupo) %>%
summarise(n=n())
View(homicides_per_group_dept)
homicides_per_group_dept <- homicide1df %>%
mutate(Grupo = case_when(
grepl("GUE",p_str) ~ "GUERRILLA",
grepl("PARA",p_str) ~ "PARAMILITARES",
grepl("EST",p_str) ~ "ESTADO",
grepl("multiple",p_str) ~ "MULTIPLE",
TRUE ~ "OTRO"
)) %>%
filter(!grepl("OTRO",Grupo, ignore.case = TRUE)) %>%
filter(!grepl("ESTADO",Grupo, ignore.case = TRUE)) %>%
filter(!grepl("MULTIPLE",Grupo, ignore.case = TRUE)) %>%
group_by(Grupo,dept_code_hecho) %>%
summarise(n=n())
View(homicides_per_group_dept)
homicides_per_group_dept <- homicide1df %>%
mutate(Grupo = case_when(
grepl("GUE",p_str) ~ "GUERRILLA",
grepl("PARA",p_str) ~ "PARAMILITARES",
grepl("EST",p_str) ~ "ESTADO",
grepl("multiple",p_str) ~ "MULTIPLE",
TRUE ~ "OTRO"
)) %>%
filter(!grepl("OTRO",Grupo, ignore.case = TRUE)) %>%
filter(!grepl("ESTADO",Grupo, ignore.case = TRUE)) %>%
filter(!grepl("MULTIPLE",Grupo, ignore.case = TRUE)) %>%
group_by(Grupo,dept_code_hecho) %>%
summarise(n=n()) %>%
group_by(dept_code_hecho)
View(homicides_per_group_dept)
View(homicides_per_group_dept)
homicides_per_group_dept <- homicide1df %>%
mutate(Grupo = case_when(
grepl("GUE",p_str) ~ "GUERRILLA",
grepl("PARA",p_str) ~ "PARAMILITARES",
grepl("EST",p_str) ~ "ESTADO",
grepl("multiple",p_str) ~ "MULTIPLE",
TRUE ~ "OTRO"
)) %>%
filter(!grepl("OTRO",Grupo, ignore.case = TRUE)) %>%
filter(!grepl("ESTADO",Grupo, ignore.case = TRUE)) %>%
filter(!grepl("MULTIPLE",Grupo, ignore.case = TRUE)) %>%
group_by(Grupo,dept_code_hecho) %>%
summarise(n=n()) %>%
group_by(dept_code_hecho) %>%
top_n(1, wt = n)
View(homicides_per_group_dept)
library(readr)
library(ggplot2)
library(disk.frame)
library(dplyr)
library(purrr)
#Importar archivos csv
#ruta de los archivos
homicide_route <- "../Homicidio.csv/verdata-homicidio-R99.csv"
kidnapping_route <- "../Secuestro.csv/verdata-secuestro-R99.csv"
disappearances_route <- "../Desaparicion.csv/verdata-desaparicion-R99.csv"
recruitment_route <-"../Reclutamiento.csv/verdata-reclutamiento-R99.csv"
#Leer csv
homicide1df <-read.csv(homicide_route)
kidnapping1df <-read.csv(kidnapping_route)
recruitment1df <-read.csv(recruitment_route)
disappearance1df <-read.csv(disappearances_route)
#exploracion de datos
#revisar si hay campos na en los datafrmaes
print(any(is.na(homicide1df)))
#revisar si hay campos nan en los dataframes
print(all(apply(homicide1df,2,function(x) all(!is.nan(x)))))
print(all(apply(kidnapping1df,2,function(x) all(!is.nan(x)))))
print(any(is.na(kidnapping1df)))
print(any(is.na(recruitment1df)))
print(all(apply(recruitment1df,2,function(x) all(!is.nan(x)))))
print(all(apply(disappearance1df,2,function(x) all(!is.nan(x)))))
print(any(is.na(disappearance1df)))
library(readr)
library(ggplot2)
library(disk.frame)
library(dplyr)
library(purrr)
library(tidyr)
#revisar si el id conecta diferentes hechos
valores_comunes <- homicide1df$match_group_id %in% kidnapping1df$match_group_id
print(any(valores_comunes)) #mostrar si existen filas con la misma id en los df
#generar una lista de filas  en comun
valores_comunes2 <- intersect(homicide1df$match_group_id, kidnapping1df$match_group_id)
#comprobar
print(valores_comunes2)
fila_deseada <- filter(kidnapping1df,match_group_id=="af42ca884de6db37305fa0ed47cb82a50f523aea")
#volver caracter la columna de departamentos y municipios y concatenar un cero a la izquierda para poder luego usar map
#quitar columnas no deseadas
#homicide
#aplicando mutate para cambiar el tipo de variable
homicide1df <- homicide1df %>% mutate(
dept_code_hecho = ifelse(dept_code_hecho < 10 , sprintf("%02d", dept_code_hecho) %>% as.character(), as.character(dept_code_hecho)),
muni_code_hecho = ifelse(dept_code_hecho < 10 , as.character() %>% paste("0", muni_code_hecho, sep = "") , as.character(muni_code_hecho))
)
#eliminando columnas
homicide1df <-homicide1df[,-c(3:36,38:45,1,51,47,49:51,53 )]
#homicide1df$muni_code_hecho <- substr(homicide1df$muni_code_hecho, nchar(homicide1df$muni_code_hecho) - 2, nchar(homicide1df$muni_code_hecho))
#disappearance
disappearance1df <- disappearance1df %>% mutate(
dept_code_hecho = ifelse(dept_code_hecho < 10 , sprintf("%02d", dept_code_hecho) %>% as.character(), as.character(dept_code_hecho)),
muni_code_hecho = ifelse(muni_code_hecho < 10 , sprintf("%02d", muni_code_hecho) %>% as.character(), as.character(muni_code_hecho))
)
disappearance1df <-disappearance1df[,-c(3:36,1,38:47,49,51:53,55)]
#disappearance1df$muni_code_hecho <- substr(disappearance1df$muni_code_hecho, nchar(disappearance1df$muni_code_hecho) - 2, nchar(disappearance1df$muni_code_hecho))
#kidnapping
kidnapping1df <- kidnapping1df %>% mutate(
dept_code_hecho = ifelse(dept_code_hecho < 10 , sprintf("%02d", dept_code_hecho) %>% as.character(), as.character(dept_code_hecho)),
muni_code_hecho = ifelse(muni_code_hecho < 10 , sprintf("%02d", muni_code_hecho) %>% as.character(), as.character(muni_code_hecho))
)
kidnapping1df <-kidnapping1df[,-c(3:36,38:45,1,51,47,49:51,53 )]
#kidnapping1df$muni_code_hecho <- substr(kidnapping1df$muni_code_hecho, nchar(kidnapping1df$muni_code_hecho) - 2, nchar(kidnapping1df$muni_code_hecho))
#recruitment
recruitment1df <- recruitment1df %>% mutate(
dept_code_hecho = ifelse(dept_code_hecho < 10 , sprintf("%02d", dept_code_hecho) %>% as.character(), as.character(dept_code_hecho)),
muni_code_hecho = ifelse(muni_code_hecho < 10 , sprintf("%02d", muni_code_hecho) %>% as.character(), as.character(muni_code_hecho))
)
recruitment1df <-recruitment1df[,-c(3:36,38:45,1,51,47,49:51,53 )]
#recruitment1df$muni_code_hecho <- substr(recruitment1df$muni_code_hecho, nchar(recruitment1df$muni_code_hecho) - 2, nchar(recruitment1df$muni_code_hecho))
#aplicando las funciones de dplyr para un data frame
#datos por municipio
homicides_group_year_mun <- homicide1df %>%
group_by(yy_hecho,muni_code_hecho, dept_code_hecho) %>%
summarise(n=n())
homicides_group_mun <- homicide1df %>%
group_by(muni_code_hecho) %>%
summarise(n=n())
homicides_group_dept <- homicide1df %>%
group_by(dept_code_hecho) %>%
summarise(n=n())
homicides_per_group_dept <- homicide1df %>%
mutate(Grupo = case_when(
grepl("GUE",p_str) ~ "GUERRILLA",
grepl("PARA",p_str) ~ "PARAMILITARES",
grepl("EST",p_str) ~ "ESTADO",
grepl("multiple",p_str) ~ "MULTIPLE",
TRUE ~ "OTRO"
)) %>%
filter(!grepl("OTRO",Grupo, ignore.case = TRUE)) %>%
filter(!grepl("ESTADO",Grupo, ignore.case = TRUE)) %>%
filter(!grepl("MULTIPLE",Grupo, ignore.case = TRUE)) %>%
group_by(Grupo,dept_code_hecho) %>%
summarise(n=n()) %>%
group_by(dept_code_hecho) %>%
top_n(1, wt = n)
homicides_group_dept <- homicide1df %>%
group_by(dept_code_hecho,p_str) %>%
summarise(n=n())
# datos por año
#Agrupar datos por año del hecho y contando
disappearance_per_year <- disappearance1df%>%
group_by(yy_hecho) %>%
summarise(n=n())
homicides_per_year <- homicide1df%>%
group_by(yy_hecho) %>%
summarise(n=n())
kidnapping_per_year <- kidnapping1df%>%
group_by(yy_hecho) %>%
summarise(n=n())
recruitment_per_year <- recruitment1df%>%
group_by(yy_hecho) %>%
summarise(n=n())
lista_hechos <- list(disappearance_per_year,homicides_per_year,recruitment_per_year,kidnapping_per_year)
#total de violencia por  año
total_per_year <-lista_hechos%>%
reduce(full_join, by = "yy_hecho") %>% #unir por la columna año
replace_na(replace= list(n.x.x =0 , n.y.y=0 , n.x=0, n.y=0)) %>% #reemplazar por cero los valores NA
mutate(total=rowSums(select(., starts_with("n")))) #sumar los hechos
total_per_year <-total_per_year[,-c(2:5)] #eliminar las columnas sobrantes
####
#datos por grupo
homicides_per_group <- homicide1df %>%
mutate(Grupo = case_when(
grepl("GUE",p_str) ~ "GUERRILLA",
grepl("PARA",p_str) ~ "PARAMILITARES",
grepl("EST",p_str) ~ "ESTADO",
grepl("multiple",p_str) ~ "MULTIPLE",
TRUE ~ "OTRO"
)) %>%
group_by(yy_hecho,Grupo) %>%
summarise(n=n())
kidnapping_per_group <- kidnapping1df %>%
mutate(Grupo = case_when(
grepl("GUE",p_str) ~ "GUERRILLA",
grepl("PARA",p_str) ~ "PARAMILITARES",
grepl("EST",p_str) ~ "ESTADO",
grepl("multiple",p_str) ~ "MULTIPLE",
TRUE ~ "OTRO"
)) %>%
group_by(yy_hecho,Grupo) %>%
summarise(n=n())
disappearance_per_group <- disappearance1df %>%
mutate(Grupo = case_when(
grepl("GUE",p_str) ~ "GUERRILLA",
grepl("PARA",p_str) ~ "PARAMILITARES",
grepl("EST",p_str) ~ "ESTADO",
grepl("multiple",p_str) ~ "MULTIPLE",
TRUE ~ "OTRO"
)) %>%
group_by(yy_hecho,Grupo) %>%
summarise(n=n())
#secuestros que llevan a homicidios
kidnapp_homicidie <-inner_join(homicide1df, kidnapping1df, by = "match_group_id")
kidnapping_homicide_per_group <- kidnapp_homicidie %>%
mutate(Grupo = case_when(
grepl("GUE",p_str.x) ~ "GUERRILLA",
grepl("PARA",p_str.x) ~ "PARAMILITARES",
grepl("EST",p_str.x) ~ "ESTADO",
grepl("multiple",p_str.x) ~ "MULTIPLE",
TRUE ~ "OTRO"
)) %>%
group_by(yy_hecho.x,Grupo) %>%
summarise(n=n())
View(homicides_per_group_dept)
homicides_per_group_dept <- homicide1df %>%
mutate(Grupo = case_when(
grepl("GUE",p_str) ~ "GUERRILLA",
grepl("PARA",p_str) ~ "PARAMILITARES",
grepl("EST",p_str) ~ "ESTADO",
grepl("multiple",p_str) ~ "MULTIPLE",
TRUE ~ "OTRO"
)) %>%
filter(!grepl("OTRO",Grupo, ignore.case = TRUE)) %>%
filter(!grepl("ESTADO",Grupo, ignore.case = TRUE)) %>%
filter(!grepl("MULTIPLE",Grupo, ignore.case = TRUE)) %>%
group_by(Grupo,dept_code_hecho) %>%
summarise(n=n()) %>%
group_by(dept_code_hecho) %>%
top_n(1, wt = n)
homicides_group_dept <-homicides_per_group_dept[,-c(3)]
library(sf)
library(tmap)
library(readr)
library(ggplot2)
library(disk.frame)
library(dplyr)
library(purrr)
#mapa homicidios historico por municipio
map <- st_read("Mapas_dept/DepartamentosVeredas.shp")
homicides_group_dept$DPTO_CCDGO<-factor(homicides_group_dept$dept_code_hecho)
homicides_group_dept$dept_code_hecho<-NULL
homicides_group_dept$homicidios<-homicides_group_dept$n
homicides_group_dept$n<-NULL
map <- map[,c(1,2)]
map <- left_join(map, homicides_group_dept)
summary(map)
homicides_per_group_dept <- homicide1df %>%
mutate(Grupo = case_when(
grepl("GUE",p_str) ~ "GUERRILLA",
grepl("PARA",p_str) ~ "PARAMILITARES",
grepl("EST",p_str) ~ "ESTADO",
grepl("multiple",p_str) ~ "MULTIPLE",
TRUE ~ "OTRO"
)) %>%
filter(!grepl("OTRO",Grupo, ignore.case = TRUE)) %>%
filter(!grepl("ESTADO",Grupo, ignore.case = TRUE)) %>%
filter(!grepl("MULTIPLE",Grupo, ignore.case = TRUE)) %>%
group_by(Grupo,dept_code_hecho) %>%
summarise(n=n()) %>%
group_by(dept_code_hecho) %>%
top_n(1, wt = n)
homicides_group_dept <-homicides_per_group_dept[2,1]
View(homicides_per_group_dept)
homicides_per_group_dept <- homicide1df %>%
mutate(Grupo = case_when(
grepl("GUE",p_str) ~ "GUERRILLA",
grepl("PARA",p_str) ~ "PARAMILITARES",
grepl("EST",p_str) ~ "ESTADO",
grepl("multiple",p_str) ~ "MULTIPLE",
TRUE ~ "OTRO"
)) %>%
filter(!grepl("OTRO",Grupo, ignore.case = TRUE)) %>%
filter(!grepl("ESTADO",Grupo, ignore.case = TRUE)) %>%
filter(!grepl("MULTIPLE",Grupo, ignore.case = TRUE)) %>%
group_by(Grupo,dept_code_hecho) %>%
summarise(n=n()) %>%
group_by(dept_code_hecho) %>%
top_n(1, wt = n)
homicides_group_dept <-homicides_per_group_dept[,-c(3)]
map2 <- st_read("Mapas_dept/DepartamentosVeredas.shp")
homicides_per_group_dept$DPTO_CCDGO<-factor(homicides_per_group_dept$dept_code_hecho)
homicides_per_group_dept$dept_code_hecho<-NULL
homicides_per_group_dept$Grupo_ar<-homicides_per_group_dept$Grupo
homicides_per_group_dept$Grupo<-NULL
map2 <- map2[,c(1,2)]
map2 <- left_join(map2, homicides_per_group_dept)
tm_shape(map2) +
tm_borders() +
tm_fill("Grupo_ar", palette = "Set3") +
tm_layout(legend.position = c("right", "bottom"))
