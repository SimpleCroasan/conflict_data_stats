---
title: "Hechos del conflicto armado en Colombia"
author: "Oscar Torrens , Cristian Hernández , Isidro Herrera"
date: "2023-12-02"
output: 
  html_document:
    theme: darkly
    toc: TRUE 
    toc_float: TRUE 
    number_sections: TRUE
    code_folding: show
    
lang: es-ES


---

# Introducción
## ¿La creencia popular es acorde a los hechos?

A lo largo de la historia reciente de Colombia, se ha planteado como una problemática el conflicto armado que azota al país, hasta el punto de formar parte del día a día de muchos Colombianos. Sin embargo, es valido preguntar: ¿Que tanto sabemos al respecto? ¿Que dicen los datos de lo que sabemos? ¿Que tanto ha afectado el conflicto armado al país y de que manera?.

A continuación se hará un análisis a múltiples conjuntos de datos relacionados con el conflicto armado en Colombia con el fin de responder a la siguiente pregunta ¿Que tan acorde es la perspectiva popular de los hechos que rodean el conflicto con los hechos en si mismos?. Para poder responder las preguntas anteriormente planteadas se realizarán agrupaciones considerando el hecho ocurrido , autores, región, año del hecho entre otras. Ademas se realizarán gráficas para poder visualizar los resultados del análisis.


# Paquetes de R requeridos

Los paquetes requeridos para la realización del código fueron los siguientes:
```{r,eval=FALSE}
library(sf)  #Leer los archivos pertinentes para la creación de mapas
library(tmap) #Trabajar con mapas
library(readr) #leer y escribir archivos tipo csv
library(ggplot2) #Realizar gráficas
library(dplyr) #poder realizar operaciones sobre dataframes de manera simple
library(tidyr) #poder cambiar valores NA por cero en un dataframe
library(purrr) #poder trabajar con dataframes usando la funcion reduce

```


```{r, message=FALSE, include=FALSE, results='hide'}
library(sf)  #Leer los archivos pertinentes para la creación de mapas
library(tmap) #Trabajar con mapas
library(readr) #leer y escribir archivos tipo csv
library(ggplot2) #Realizar gráficas
library(dplyr) #poder realizar operaciones sobre dataframes de manera simple
library(tidyr) #poder cambiar valores NA por cero en un dataframe
library(purrr) #poder trabajar con dataframes usando la funcion reduce

```

Adicional y opcionalmente se puede usar la siguiente librería para poder leer grandes cantidades de csv sin tener inconvenientes con el disco. Sin embargo el código para cargar y trabajar con esa cantidad de archivos csv es meramente opcional y no será considerado para este proyecto.

```{r, eval=FALSE}

library(disk.frame)
```
---

# Preparación de los datos

## Fuente de los datos

El conjunto de datos utilizado fué sacado de los micro datos del DANE, se encuentran en el siguiente enlace:

 * [Link a hipervinculo] (https://microdatos.dane.gov.co/index.php/catalog/795)
 
## Informacion general sobre los datos

Los datos en cuestión consisten en una recopilación de diferentes hechos registrados en diferentes bases de datos realizada por el DANE. Los datos representan diferentes hechos ocurridos en el marco del conflicto armado desde el año 1985 hasta el año 2018. Este conjunto de datos fué publicado en el año 2023 para la comisión de la verdad.

Los datos se dividen en cuatro carpetas de csv correspondientes a homicidios, secuestros, reclutamientos y desapariciones.Cada carpeta contiene cien archivos csv correspondientes a cien replicas diferentes hechas para mantener una cierta integridad de los datos.La diferencia entre los datos que existen en diferentes replicas es mínima dada la función que cumplen las replicas en este caso y, por tanto, solo bastó con elegir una de las replicas para este proyecto.

## Informacion especifica sobre los datos.

A continuación se muestran los datos mas relevantes para este proyecto.


### Id

match_group_id: Es un identificador único en un grupo de csv, esto significa que puede estar presente la misma id en varios archivos csv. Esta información es útil para poder relacionar datos de varios archivos csv usando este identificador.

### muni_code_hecho y dept_code_hecho

muni_code_hecho: Codigo del municipio en que ocurrió el hecho.

dept_code_hecho: Codigo del departamento en el que ocurrió el hecho.

Ambas variables son de tipo numérico.

### p_str

p_str: Grupo al cual se le atribuye el hecho.Variable tipo carácter.

### yy_hecho

yy_hecho: año en el cual ocurrió el hecho. Variable tipo numérico.

## Variables descartadas

* in # : Son treinta y cuatro columnas que representan en que bases de datos está el registro actual.

* edad_categoría: Categoría de edad de la persona victima del hecho.

* edad_categoría_imputed: Puede tomar True o False si es resultado de imputación o no.

* edad_jep: Edad de la persona victima del hecho.

* edad_jep_imputed: Puede tomar True o False si es resultado de imputación o no.

* etnia: Etnia de la persona victima del hecho.

* etnia_imputed: Puede tomar True o False si es resultado de imputación o no.

* sexo: sexo de la persona victima del hecho.

* sexo_imputed: Puede tomar True o False si es resultado de imputación o no.

* yy_mes_hecho: Año y mes del hecho.

* is_conflict: Puede tomar True o False si se relaciona con el conflicto armado o no.

* is_conflict_imputed: Puede tomar True o False si es resultado de imputación o no.

* is_muni_hecho_imputed: Puede tomar True o False si es resultado de imputación o no.

## Importar los datos

Para importar los datos se debe implementar el siguiente código:

```{r}
#Importar archivos csv

#ruta de los archivos
homicide_route <- "../Homicidio.csv/verdata-homicidio-R99.csv"
kidnapping_route <- "../Secuestro.csv/verdata-secuestro-R99.csv"
disappearances_route <- "../Desaparicion.csv/verdata-desaparicion-R99.csv"
recruitment_route <-"../Reclutamiento.csv/verdata-reclutamiento-R99.csv"

#Leer csv
homicide1df <-read.csv(homicide_route)
kidnapping1df <-read.csv(kidnapping_route)
recruitment1df <-read.csv(recruitment_route)
disappearance1df <-read.csv(disappearances_route)

```

## Revisar los datos
Para revisar si los dataframes tienen espacios na o nan se utilizó el siguiente código:

```{r, eval=FALSE}
#exploracion de datos

#revisar si hay campos na en los datafrmaes
print(any(is.na(homicide1df)))

#revisar si hay campos nan en los dataframes
print(all(apply(homicide1df,2,function(x) all(!is.nan(x)))))



print(all(apply(kidnapping1df,2,function(x) all(!is.nan(x)))))
print(any(is.na(kidnapping1df)))



print(any(is.na(recruitment1df)))
print(all(apply(recruitment1df,2,function(x) all(!is.nan(x)))))



print(all(apply(disappearance1df,2,function(x) all(!is.nan(x)))))
print(any(is.na(disappearance1df)))



```

Los dataframes no presentaron inconvenientes.


## Quitar las columnas pertinentes y modificar campos

Es vital para este proyecto poder mapear los códigos de los departamentos y municipios para tener una vista geográfica de los hechos.Fué necesario cambiar a tipo caractér las columnas de departamento y municipio.

En el siguiente código se hace el cambio de tipo usando la funcion mutate y se eliminan las columnas pertinentes:
```{r, eval=FALSE}

#homicide
#aplicando mutate para cambiar el tipo de variable
homicide1df <- homicide1df %>% mutate(
  dept_code_hecho = ifelse(dept_code_hecho < 10 , sprintf("%02d", dept_code_hecho) %>% as.character(), as.character(dept_code_hecho)),
  muni_code_hecho = ifelse(dept_code_hecho < 10 , as.character() %>% paste("0", muni_code_hecho, sep = "") , as.character(muni_code_hecho))
)
#eliminando columnas
homicide1df <-homicide1df[,-c(3:36,38:45,1,51,47,49:51,53 )]
#homicide1df$muni_code_hecho <- substr(homicide1df$muni_code_hecho, nchar(homicide1df$muni_code_hecho) - 2, nchar(homicide1df$muni_code_hecho))




```


Codigo completo:

```{r, echo=TRUE,results='hide'}

#homicide
#aplicando mutate para cambiar el tipo de variable
homicide1df <- homicide1df %>% mutate(
  dept_code_hecho = ifelse(dept_code_hecho < 10 , sprintf("%02d", dept_code_hecho) %>% as.character(), as.character(dept_code_hecho)),
  muni_code_hecho = ifelse(dept_code_hecho < 10 , as.character() %>% paste("0", muni_code_hecho, sep = "") , as.character(muni_code_hecho))
)
#eliminando columnas
homicide1df <-homicide1df[,-c(3:36,38:45,1,51,47,49:51,53 )]
#homicide1df$muni_code_hecho <- substr(homicide1df$muni_code_hecho, nchar(homicide1df$muni_code_hecho) - 2, nchar(homicide1df$muni_code_hecho))



#disappearance
disappearance1df <- disappearance1df %>% mutate(
  dept_code_hecho = ifelse(dept_code_hecho < 10 , sprintf("%02d", dept_code_hecho) %>% as.character(), as.character(dept_code_hecho)),
  muni_code_hecho = ifelse(muni_code_hecho < 10 , sprintf("%02d", muni_code_hecho) %>% as.character(), as.character(muni_code_hecho))
)
disappearance1df <-disappearance1df[,-c(3:36,1,38:47,49,51:53,55)]
#disappearance1df$muni_code_hecho <- substr(disappearance1df$muni_code_hecho, nchar(disappearance1df$muni_code_hecho) - 2, nchar(disappearance1df$muni_code_hecho))

#kidnapping

kidnapping1df <- kidnapping1df %>% mutate(
  dept_code_hecho = ifelse(dept_code_hecho < 10 , sprintf("%02d", dept_code_hecho) %>% as.character(), as.character(dept_code_hecho)),
  muni_code_hecho = ifelse(muni_code_hecho < 10 , sprintf("%02d", muni_code_hecho) %>% as.character(), as.character(muni_code_hecho))
)

kidnapping1df <-kidnapping1df[,-c(3:36,38:45,1,51,47,49:51,53 )]
#kidnapping1df$muni_code_hecho <- substr(kidnapping1df$muni_code_hecho, nchar(kidnapping1df$muni_code_hecho) - 2, nchar(kidnapping1df$muni_code_hecho))


#recruitment
recruitment1df <- recruitment1df %>% mutate(
  dept_code_hecho = ifelse(dept_code_hecho < 10 , sprintf("%02d", dept_code_hecho) %>% as.character(), as.character(dept_code_hecho)),
  muni_code_hecho = ifelse(muni_code_hecho < 10 , sprintf("%02d", muni_code_hecho) %>% as.character(), as.character(muni_code_hecho))
)

recruitment1df <-recruitment1df[,-c(3:36,38:45,1,51,47,49:51,53 )]
#recruitment1df$muni_code_hecho <- substr(recruitment1df$muni_code_hecho, nchar(recruitment1df$muni_code_hecho) - 2, nchar(recruitment1df$muni_code_hecho))



```

## Revision de match_id

Este código se usó para comprobar la relación y funcionamiento del Id dentro de un grupo de csv:

```{r, eval=FALSE}

#revisar si el id conecta diferentes hechos
valores_comunes <- homicide1df$match_group_id %in% kidnapping1df$match_group_id
print(any(valores_comunes)) #mostrar si existen filas con la misma id en los df

#generar una lista de filas  en comun
valores_comunes2 <- intersect(homicide1df$match_group_id, kidnapping1df$match_group_id)

#comprobar
print(valores_comunes2)
fila_deseada <- filter(kidnapping1df,match_group_id=="af42ca884de6db37305fa0ed47cb82a50f523aea")



```

La intención detrás del código era verificar si existía una relación entre los csv con los Id y cual era la naturaleza de esa relación. De esta forma se pueden hallar coincidencias entre varios hechos.

A continuación se muestra un ejemplo del dataframe generado tras filtrar las variables:

```{r echo=FALSE}
knitr::kable(
  head(homicide1df),
  caption = "Homicidios",
  table.attr = 'class="table table-striped table-bordered"',
  align = "c",
  format = "html"
  
)
```

# Analisis de los datos

## Agrupando los datos en funcion de las variables de interés

Para poder obtener información relevante de los conjuntos de datos es importante agrupar los datos. En este caso es vital realizar agrupaciones en función del año , el municipio y el grupo autor del hecho en cuestión.

### Agrupación por Departamento


```{r, echo=TRUE,results='hide',include=FALSE}

#homicidios por departamento
homicides_group_dept <- homicide1df %>% 
  group_by(dept_code_hecho) %>%
  summarise(n=n())

homicides_per_group_dept <- homicide1df %>%
  mutate(Grupo = case_when(
    
    grepl("GUE",p_str) ~ "GUERRILLA",
    grepl("PARA",p_str) ~ "PARAMILITARES",
    grepl("EST",p_str) ~ "ESTADO",
    grepl("multiple",p_str) ~ "MULTIPLE",
    TRUE ~ "OTRO"
  )) %>%
  filter(!grepl("OTRO",Grupo, ignore.case = TRUE)) %>%
  filter(!grepl("ESTADO",Grupo, ignore.case = TRUE)) %>%
  filter(!grepl("MULTIPLE",Grupo, ignore.case = TRUE)) %>%
  group_by(Grupo,dept_code_hecho) %>%
  summarise(n=n()) %>%
  group_by(dept_code_hecho) %>%
  top_n(1, wt = n)

homicides_per_group_dept <-homicides_per_group_dept[,-c(3)]

#secuestros por departamento
kidnapp_group_dept <- kidnapping1df %>% 
  group_by(dept_code_hecho) %>%
  summarise(n=n())

kidnapp_per_group_dept <- kidnapping1df %>%
  mutate(Grupo = case_when(
    
    grepl("GUE",p_str) ~ "GUERRILLA",
    grepl("PARA",p_str) ~ "PARAMILITARES",
    grepl("EST",p_str) ~ "ESTADO",
    grepl("multiple",p_str) ~ "MULTIPLE",
    TRUE ~ "OTRO"
  )) %>%
  filter(!grepl("OTRO",Grupo, ignore.case = TRUE)) %>%
  filter(!grepl("ESTADO",Grupo, ignore.case = TRUE)) %>%
  filter(!grepl("MULTIPLE",Grupo, ignore.case = TRUE)) %>%
  group_by(Grupo,dept_code_hecho) %>%
  summarise(n=n()) %>%
  group_by(dept_code_hecho) %>%
  top_n(1, wt = n)

kidnapp_per_group_dept <-kidnapp_per_group_dept[,-c(3)]

#reclutamiento
recruitment_group_dept <- recruitment1df %>% 
  group_by(dept_code_hecho) %>%
  summarise(n=n())





```


```{r, eval=FALSE}


#homicidios por departamento
homicides_group_dept <- homicide1df %>% 
  group_by(dept_code_hecho) %>%
  summarise(n=n())

homicides_per_group_dept <- homicide1df %>%
  mutate(Grupo = case_when(
    
    grepl("GUE",p_str) ~ "GUERRILLA",
    grepl("PARA",p_str) ~ "PARAMILITARES",
    grepl("EST",p_str) ~ "ESTADO",
    grepl("multiple",p_str) ~ "MULTIPLE",
    TRUE ~ "OTRO"
  )) %>%
  filter(!grepl("OTRO",Grupo, ignore.case = TRUE)) %>%
  filter(!grepl("ESTADO",Grupo, ignore.case = TRUE)) %>%
  filter(!grepl("MULTIPLE",Grupo, ignore.case = TRUE)) %>%
  group_by(Grupo,dept_code_hecho) %>%
  summarise(n=n()) %>%
  group_by(dept_code_hecho) %>%
  top_n(1, wt = n)

homicides_per_group_dept <-homicides_per_group_dept[,-c(3)]

#secuestros por departamento
kidnapp_group_dept <- kidnapping1df %>% 
  group_by(dept_code_hecho) %>%
  summarise(n=n())

kidnapp_per_group_dept <- kidnapping1df %>%
  mutate(Grupo = case_when(
    
    grepl("GUE",p_str) ~ "GUERRILLA",
    grepl("PARA",p_str) ~ "PARAMILITARES",
    grepl("EST",p_str) ~ "ESTADO",
    grepl("multiple",p_str) ~ "MULTIPLE",
    TRUE ~ "OTRO"
  )) %>%
  filter(!grepl("OTRO",Grupo, ignore.case = TRUE)) %>%
  filter(!grepl("ESTADO",Grupo, ignore.case = TRUE)) %>%
  filter(!grepl("MULTIPLE",Grupo, ignore.case = TRUE)) %>%
  group_by(Grupo,dept_code_hecho) %>%
  summarise(n=n()) %>%
  group_by(dept_code_hecho) %>%
  top_n(1, wt = n)

kidnapp_per_group_dept <-kidnapp_per_group_dept[,-c(3)]

#reclutamiento
recruitment_group_dept <- recruitment1df %>% 
  group_by(dept_code_hecho) %>%
  summarise(n=n())






```

En esta agrupación de los datos se usaron expresiones regulares con grepl. Se agruparon las guerrillas, los paramilitares y otros grupos en funcion del departamento. Adicionalmente se tiene un historico por departamento para cada hecho.





### Agrupación por año

```{r, echo=TRUE,results='hide'}

# datos por año

#Agrupar datos por año del hecho y contando

disappearance_per_year <- disappearance1df%>% 
  group_by(yy_hecho) %>% #agrupa en función de la columna yy_hecho
  summarise(n=n()) #cuenta el numero de filas en función de la agrupación

homicides_per_year <- homicide1df%>% 
  group_by(yy_hecho) %>% 
  summarise(n=n()) 

kidnapping_per_year <- kidnapping1df%>% 
  group_by(yy_hecho) %>% 
  summarise(n=n()) 

recruitment_per_year <- recruitment1df%>% 
  group_by(yy_hecho) %>% 
  summarise(n=n()) 

lista_hechos <- list(disappearance_per_year,homicides_per_year,recruitment_per_year,kidnapping_per_year)

#total de violencia por  año
total_per_year <-lista_hechos%>%
  reduce(full_join, by = "yy_hecho") %>% #unir por la columna año
  replace_na(replace= list(n.x.x =0 , n.y.y=0 , n.x=0, n.y=0)) %>% #reemplazar por cero los valores NA
  mutate(total=rowSums(select(., starts_with("n")))) #sumar los hechos
total_per_year <-total_per_year[,-c(2:5)] #eliminar las columnas sobrantes
  


```

El resultado de esta agrupación es un dataframe por cada conjunto de datos(desapariciones, homicidios, secuestros y reclutamiento respectivamente). El dataframe generado consta de dos columnas "yy_hecho" que representa el año y "n" que representa el numero de veces que ocurrió el hecho en ese año.

Es importante recalcar que estos dataframes serán utilizados en futuras secciones.


```{r echo=FALSE}
knitr::kable(
  head(homicides_per_year),
  caption = "Agrupación, homicidios por año",
  table.attr = 'class="table table-striped table-bordered"',
  align = "c",
  format = "html"
  
)
```

También se tiene el total de hechos violentos por año:

```{r echo=FALSE}
knitr::kable(
  head(total_per_year),
  caption = "Agrupación, total de hechos por año",
  table.attr = 'class="table table-striped table-bordered"',
  align = "c",
  format = "html"
  
)
```

### Agrupación por grupo armado

```{r, echo=TRUE,results='hide',include=FALSE}
homicides_per_group <- homicide1df %>%
  mutate(Grupo = case_when(
    
    
    grepl("GUE",p_str) ~ "GUERRILLA",
    grepl("PARA",p_str) ~ "PARAMILITARES",
    grepl("EST",p_str) ~ "ESTADO",
    grepl("multiple",p_str) ~ "MULTIPLE",
    TRUE ~ "OTRO"
  )) %>%
  group_by(yy_hecho,Grupo) %>%
  summarise(n=n())


kidnapping_per_group <- kidnapping1df %>%
  mutate(Grupo = case_when(
    
    
    grepl("GUE",p_str) ~ "GUERRILLA",
    grepl("PARA",p_str) ~ "PARAMILITARES",
    grepl("EST",p_str) ~ "ESTADO",
    grepl("multiple",p_str) ~ "MULTIPLE",
    TRUE ~ "OTRO"
  )) %>%
  group_by(yy_hecho,Grupo) %>%
  summarise(n=n())

disappearance_per_group <- disappearance1df %>%
  mutate(Grupo = case_when(
    
    
    grepl("GUE",p_str) ~ "GUERRILLA",
    grepl("PARA",p_str) ~ "PARAMILITARES",
    grepl("EST",p_str) ~ "ESTADO",
    grepl("multiple",p_str) ~ "MULTIPLE",
    TRUE ~ "OTRO"
  )) %>%
  group_by(yy_hecho,Grupo) %>%
  summarise(n=n())

  


```


```{r, eval=FALSE}
homicides_per_group <- homicide1df %>%
  mutate(Grupo = case_when(
    
    #grepl sirve para encontrar las expresiones regulares 
    #existen varias guerrillas pero el recopilatorio implica que se tomen como una sola
    
    grepl("GUE",p_str) ~ "GUERRILLA",
    grepl("PARA",p_str) ~ "PARAMILITARES",
    grepl("EST",p_str) ~ "ESTADO",
    grepl("multiple",p_str) ~ "MULTIPLE",
    TRUE ~ "OTRO"
  )) %>%
  group_by(yy_hecho,Grupo) %>% #agrupacion y conteon
  summarise(n=n())


kidnapping_per_group <- kidnapping1df %>%
  mutate(Grupo = case_when(
    
    
    grepl("GUE",p_str) ~ "GUERRILLA",
    grepl("PARA",p_str) ~ "PARAMILITARES",
    grepl("EST",p_str) ~ "ESTADO",
    grepl("multiple",p_str) ~ "MULTIPLE",
    TRUE ~ "OTRO"
  )) %>%
  group_by(yy_hecho,Grupo) %>%
  summarise(n=n())



disappearance_per_group <- disappearance1df %>%
  mutate(Grupo = case_when(
    
    
    grepl("GUE",p_str) ~ "GUERRILLA",
    grepl("PARA",p_str) ~ "PARAMILITARES",
    grepl("EST",p_str) ~ "ESTADO",
    grepl("multiple",p_str) ~ "MULTIPLE",
    TRUE ~ "OTRO"
  )) %>%
  group_by(yy_hecho,Grupo) %>%
  summarise(n=n())

  


```

Para este caso solo se tomaron en cuenta los secuestros, desaparaciones y homicidios cometidos por diferentes grupos al margen de la ley. Es importante considerar que existen varias guerrillas así como varios grupos al margen de la ley pero en este caso se tomará la cantidad de hechos violentos cometidos por una clase de grupo en general, por ejemplo las guerrillas en general.

## Graficas de los hechos

### Hechos por año

```{r, echo=TRUE,results='hide', warning=FALSE}

#plot total per year

ggplot(homicides_per_year, aes(x = yy_hecho, y = n, color = "homicidios")) +
  geom_line(data = total_per_year, aes(x = yy_hecho, y = total, linetype = "TOTAL"),color="black")+
  geom_line(size =0.8) +
  geom_line(data = disappearance_per_year, aes(x = yy_hecho, y = n, color = "desapariciones"),size=0.8)+
  geom_line(data = kidnapping_per_year, aes(x = yy_hecho, y = n, color = "secuestros"),size=0.8)+
  geom_line(data = recruitment_per_year, aes(x = yy_hecho, y = n, color = "reclutamiento"),size=0.8)+
  labs(title = "Número de hechos por año",
       x = "Año",
       y = "Número de hechos",
       color = "tipo de hecho") +
  theme_light() +
  scale_x_continuous(breaks = seq(min(homicides_per_year$yy_hecho), max(homicides_per_year$yy_hecho), by = 3))




```

En esta gráfica se puede observar que el eje "x" representa el avance de los años y el eje "y" representa el numero de hechas respecto al año. La linea negra representa el total de hechos y las demás lineas representan la tendencia de los hechos individualmente. De esta tendencia se observa que todos los hechos se comportan de manera similar a lo largo de los años siguiendo usualmente la misma tendencia. De esta tendencia se observa que, para todos los hechos, durante el periodo comprendido entre el año 1994 y 2003, la tendencia de hechos violentos fue en su mayoría creciente y, en el periodo comprendido entre 2003 y 2006 hubo un decrecimiento para todos los hechos. Este decrecimiento en la violencia se le puede atribuir a diversos  factores como la desmovilización de grupos paramilitares que , coincide históricamente con la época de decrecimiento en la gráfica. Sin embargo es importante considerar que estas tendencias pueden deberse a varios factores y bajo ningún concepto deben atribuirsele a uno solo de ellos.

El hecho que ocurrió con mas frecuencia según la gráfica fue el homicidio estando mas cerca en números al total de los hechos que al segundo hecho mas frecuente. Es importante entender que, muy probablemente, todos estos hechos tienen una relación directa entre ellos, dado que se habla de incremento de la violencia es comprensible que todos los hechos sigan la misma tendencia, así como se puede considerar que la tendencia entre los hechos indica relación entre los mismos.


### Hechos por grupo

```{r, echo=TRUE,results='hide', warning=FALSE}

#plot homicides_per_group

ggplot(homicides_per_group, aes(x = yy_hecho, y = n, color = Grupo)) +
  geom_line(size =0.8) +
  geom_line(data = homicides_per_year, aes(x = yy_hecho, y = n, linetype = "TOTAL"),color="black")+
  labs(title = "Número de Homicidios por Año y Grupo",
       x = "Año",
       y = "Número de Homicidios",
       color = "Grupo") +
  theme_light() +
  scale_x_continuous(breaks = seq(min(homicides_per_group$yy_hecho), max(homicides_per_group$yy_hecho), by = 3))


```


En la gráfica de homicidios por grupo la linea negra representa el total de homicidios en función del año y el resto de lineas representan el numero de homicidios realizados por diversos grupos en función del año.

El grupo que más homicidios realizó fueron los paramilitares, seguidos de las guerrillas. Este resultado implica que, tal como se concibe en la cultura popular, los paramilitares solían ser mas propensos a cometer homicidios que los demás grupos.

Tambien se puede observar que, cuando el numero de homicidios por parte de los paramilitares y las guerrillas empezó a disminuir, el numero de homicidios realizados por otros grupos al margen de la ley aumentó. Este aumento se puede deber a disidencias o otros grupos que se crearon tras las desmovilización de los paramilitares entre 2003 y 2006, ya que se puede considerar que un evento como la desmovilización de un agente del conflicto implica cosas como nuevos agentes del mismo.



```{r, echo=TRUE,results='hide', warning=FALSE}

ggplot(kidnapping_per_group, aes(x = yy_hecho, y = n, color = Grupo)) +
  geom_line(size =0.8) +
  geom_line(data = kidnapping_per_year, aes(x = yy_hecho, y = n, linetype = "TOTAL"), color="black")+
  labs(title = "Número de secuestros por Año y Grupo",
       x = "Año",
       y = "Número de secuestros",
       color = "Grupo") +
  theme_light() +
  scale_x_continuous(breaks = seq(min(kidnapping_per_group$yy_hecho), max(kidnapping_per_group$yy_hecho), by = 3))


```

En la gráfica de secuestros por grupo la linea negra representa el total de Secuestros en función del año y el resto de lineas representan el numero de secuestros realizados por diversos grupos en función del año.

Se puede observar que, tal como sugiere el ideario colectivo, las guerrillas son el grupo que mas secuestros realiza, encabezando la tendencia en la gráfica, seguidos por los paramilitares y otros  grupos.

En este caso especifico se puede decir que la tendencia del total de secuestros se parece bastante a la tendencia de los secuestros cometidos por las guerrillas, demostrando así que las guerrillas fueron mas propensas a realizar secuestros siendo que la mayoría de los secuestros fueron realizados por las mismas. Estas cifras pueden indicar que las guerrillas lideraron en este apartado dado a que los secuestros eran uno de los mayores medios de ingresos para las guerrillas.

```{r, echo=TRUE,results='hide', warning=FALSE}

#plot disappearence_per_group

ggplot(disappearance_per_group, aes(x = yy_hecho, y = n, color = Grupo)) +
  geom_line(size =0.8) +
  geom_line(data = disappearance_per_year, aes(x = yy_hecho, y = n, linetype = "TOTAL"),color="black")+
  labs(title = "Número de desapariciones por Año y Grupo",
       x = "Año",
       y = "Número de desapariciones",
       color = "Grupo") +
  theme_light() +
  scale_x_continuous(breaks = seq(min(disappearance_per_group$yy_hecho), max(disappearance_per_group$yy_hecho), by = 3))



```


En la gráfica de desapariciones por grupo la linea negra representa el total de desapariciones en función del año y el resto de lineas representan el numero de desapariciones realizados por diversos grupos en función del año.

A pesar de que en el periodo comprendido entre el año 2003 y el año 2006 la tendencia de desapariciones decrece, el comportamiento de la gráfica se torna relativamente diferente al de las demás gráficas ya que mas adelante hay periodos con un crecimiento masivo de las cifras.

El grupo armado al que se le atribuyen mayor numero de desapariciones vendrían siendo los paramilitares, seguidos por los grupos guerrilleros.


```{r, echo=TRUE,results='hide', warning=FALSE}

#mapa homicidios historico por municipio
map <- st_read("Mapas_dept/DepartamentosVeredas.shp") #cargar el mapa

#Acomodar las columnas del dataframe
homicides_group_dept$DPTO_CCDGO<-factor(homicides_group_dept$dept_code_hecho)
homicides_group_dept$dept_code_hecho<-NULL
homicides_group_dept$homicidios<-homicides_group_dept$n
homicides_group_dept$n<-NULL

map <- map[,c(1,2)]

#unir las coordenadas del mapa con el dataframe

map <- left_join(map, homicides_group_dept)

summary(map)
#graficar
qtm(map,"homicidios", fill.breaks = c(0,15000,25000, 50000,75000,100000,125000,150000)) 


```

```{r, echo=TRUE,results='hide', warning=FALSE}
map2 <- st_read("Mapas_dept/DepartamentosVeredas.shp") #cargar mapas

#Acomodoar columnas
homicides_per_group_dept$DPTO_CCDGO<-factor(homicides_per_group_dept$dept_code_hecho)
homicides_per_group_dept$dept_code_hecho<-NULL
homicides_per_group_dept$Grupo_ar<-homicides_per_group_dept$Grupo
homicides_per_group_dept$Grupo<-NULL

map2 <- map2[,c(1,2)]

map2 <- left_join(map2, homicides_per_group_dept)

#graficar por grupo
tm_shape(map2) +
  tm_borders() +
  tm_fill("Grupo_ar", palette = "Set3") +
  tm_layout(legend.position = c("right", "bottom"))



```



```{r, echo=TRUE,results='hide', warning=FALSE}
map3 <- st_read("Mapas_dept/DepartamentosVeredas.shp") #cargar mapa

#acomodar columnas
kidnapp_group_dept$DPTO_CCDGO<-factor(kidnapp_group_dept$dept_code_hecho)
kidnapp_group_dept$dept_code_hecho<-NULL
kidnapp_group_dept$secuestros<-kidnapp_group_dept$n
kidnapp_group_dept$n<-NULL

map3 <- map3[,c(1,2)]

map3 <- left_join(map3, kidnapp_group_dept)

summary(map3)

#graficas
qtm(map3,"secuestros", fill.breaks = c(0,1000,3000, 5000,7000,11000))



```

```{r, echo=TRUE,results='hide', warning=FALSE}


map4 <- st_read("Mapas_dept/DepartamentosVeredas.shp") #cargar mapa

#acomodar columnas

kidnapp_per_group_dept$DPTO_CCDGO<-factor(kidnapp_per_group_dept$dept_code_hecho)
kidnapp_per_group_dept$dept_code_hecho<-NULL
kidnapp_per_group_dept$Grupo_ar<-kidnapp_per_group_dept$Grupo
kidnapp_per_group_dept$Grupo<-NULL

map4 <- map4[,c(1,2)]

map4 <- left_join(map4, kidnapp_per_group_dept)

#graficas
tm_shape(map4) +
  tm_borders() +
  tm_fill("Grupo_ar", palette = "Set3") +
  tm_layout(legend.position = c("right", "bottom"))


```




```{r, echo=TRUE,results='hide', warning=FALSE}
map5 <- st_read("Mapas_dept/DepartamentosVeredas.shp")

recruitment_group_dept$DPTO_CCDGO<-factor(recruitment_group_dept$dept_code_hecho)
recruitment_group_dept$dept_code_hecho<-NULL
recruitment_group_dept$reclutamiento<-recruitment_group_dept$n
recruitment_group_dept$n<-NULL

map5 <- map5[,c(1,2)]

map5 <- left_join(map5, recruitment_group_dept)

summary(map5)

qtm(map5,"reclutamiento", fill.breaks = c(0,500,1000, 1500,2000,2500,3000,3500))






```


### Secuestros que llevan a homicidios
---

# Conclusiones